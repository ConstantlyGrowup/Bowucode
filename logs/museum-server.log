2025-09-15 19:50:16.528 [main] INFO  com.museum.MybatisplusApplication - Starting MybatisplusApplication using Java 17.0.14 on thinkmacbook with PID 49480 (G:\dissertation\Bowucode\正确版本\museum_server\target\classes started by Ezekiel in G:\dissertation\Bowucode\正确版本\museum_server)
2025-09-15 19:50:16.529 [main] DEBUG com.museum.MybatisplusApplication - Running with Spring Boot v2.7.16, Spring v5.3.30
2025-09-15 19:50:16.530 [main] INFO  com.museum.MybatisplusApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-15 19:50:17.014 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-15 19:50:17.015 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-15 19:50:17.032 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-09-15 19:50:17.465 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8090 (http)
2025-09-15 19:50:17.471 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-15 19:50:17.471 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.80]
2025-09-15 19:50:17.577 [main] INFO  o.a.c.c.ContainerBase.[Tomcat].[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-09-15 19:50:17.577 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1017 ms
2025-09-15 19:50:17.904 [main] INFO  com.museum.MybatisplusApplication - Starting MybatisplusApplication using Java 17.0.14 on thinkmacbook with PID 44916 (G:\dissertation\Bowucode\正确版本\museum_server\target\classes started by Ezekiel in G:\dissertation\Bowucode\正确版本\museum_server)
2025-09-15 19:50:17.905 [main] DEBUG com.museum.MybatisplusApplication - Running with Spring Boot v2.7.16, Spring v5.3.30
2025-09-15 19:50:17.906 [main] INFO  com.museum.MybatisplusApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-15 19:50:17.927 [main] DEBUG c.b.m.e.spring.MybatisSqlSessionFactoryBean - Registered plugin: 'com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor@36d7a68a'
2025-09-15 19:50:17.992 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.insert
2025-09-15 19:50:17.995 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.delete
2025-09-15 19:50:17.999 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.deleteByMap
2025-09-15 19:50:18.012 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.deleteById
2025-09-15 19:50:18.014 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.deleteBatchIds
2025-09-15 19:50:18.018 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.update
2025-09-15 19:50:18.019 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.updateById
2025-09-15 19:50:18.021 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.selectById
2025-09-15 19:50:18.022 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.selectBatchIds
2025-09-15 19:50:18.022 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.selectByMap
2025-09-15 19:50:18.024 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.selectOne
2025-09-15 19:50:18.025 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.selectCount
2025-09-15 19:50:18.026 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.selectMaps
2025-09-15 19:50:18.028 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.selectMapsPage
2025-09-15 19:50:18.029 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.selectObjs
2025-09-15 19:50:18.030 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.selectList
2025-09-15 19:50:18.031 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.selectPage
2025-09-15 19:50:18.034 [main] DEBUG c.b.m.e.spring.MybatisSqlSessionFactoryBean - Parsed mapper file: 'file [G:\dissertation\Bowucode\正确版本\museum_server\target\classes\mapper\StudentMapper.xml]'
2025-09-15 19:50:18.094 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.insert
2025-09-15 19:50:18.096 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.delete
2025-09-15 19:50:18.098 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.deleteByMap
2025-09-15 19:50:18.099 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.deleteById
2025-09-15 19:50:18.100 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.deleteBatchIds
2025-09-15 19:50:18.102 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.update
2025-09-15 19:50:18.103 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.updateById
2025-09-15 19:50:18.103 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.selectById
2025-09-15 19:50:18.103 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.selectBatchIds
2025-09-15 19:50:18.104 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.selectByMap
2025-09-15 19:50:18.104 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.selectOne
2025-09-15 19:50:18.105 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.selectCount
2025-09-15 19:50:18.106 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.selectMaps
2025-09-15 19:50:18.107 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.selectMapsPage
2025-09-15 19:50:18.114 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.selectObjs
2025-09-15 19:50:18.115 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.selectList
2025-09-15 19:50:18.116 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.selectPage
2025-09-15 19:50:18.146 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.insert
2025-09-15 19:50:18.149 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.delete
2025-09-15 19:50:18.151 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.deleteByMap
2025-09-15 19:50:18.151 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.deleteById
2025-09-15 19:50:18.152 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.deleteBatchIds
2025-09-15 19:50:18.153 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.update
2025-09-15 19:50:18.153 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.updateById
2025-09-15 19:50:18.153 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.selectById
2025-09-15 19:50:18.154 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.selectBatchIds
2025-09-15 19:50:18.154 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.selectByMap
2025-09-15 19:50:18.155 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.selectOne
2025-09-15 19:50:18.156 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.selectCount
2025-09-15 19:50:18.158 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.selectMaps
2025-09-15 19:50:18.159 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.selectMapsPage
2025-09-15 19:50:18.160 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.selectObjs
2025-09-15 19:50:18.161 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.selectList
2025-09-15 19:50:18.161 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.selectPage
2025-09-15 19:50:18.171 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.insert
2025-09-15 19:50:18.172 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.delete
2025-09-15 19:50:18.173 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.deleteByMap
2025-09-15 19:50:18.174 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.deleteById
2025-09-15 19:50:18.175 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.deleteBatchIds
2025-09-15 19:50:18.176 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.update
2025-09-15 19:50:18.177 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.updateById
2025-09-15 19:50:18.177 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.selectById
2025-09-15 19:50:18.178 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.selectBatchIds
2025-09-15 19:50:18.179 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.selectByMap
2025-09-15 19:50:18.180 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.selectOne
2025-09-15 19:50:18.180 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.selectCount
2025-09-15 19:50:18.181 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.selectMaps
2025-09-15 19:50:18.182 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.selectMapsPage
2025-09-15 19:50:18.182 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.selectObjs
2025-09-15 19:50:18.183 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.selectList
2025-09-15 19:50:18.184 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.selectPage
2025-09-15 19:50:18.249 [main] INFO  org.redisson.Version - Redisson 3.13.6
2025-09-15 19:50:18.429 [redisson-netty-4-23] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for /127.0.0.1:6379
2025-09-15 19:50:18.440 [redisson-netty-4-19] INFO  org.redisson.connection.pool.MasterConnectionPool - 24 connections initialized for /127.0.0.1:6379
2025-09-15 19:50:18.471 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-15 19:50:18.474 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-15 19:50:18.492 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-09-15 19:50:18.579 [main] INFO  com.museum.config.ChromaConfig - Attempting to connect to Chroma at: http://localhost:8000/
2025-09-15 19:50:18.700 [main] INFO  com.museum.config.ChromaConfig - Successfully connected to Chroma
2025-09-15 19:50:18.715 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.insert
2025-09-15 19:50:18.716 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.delete
2025-09-15 19:50:18.716 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.deleteByMap
2025-09-15 19:50:18.717 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.deleteById
2025-09-15 19:50:18.717 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.deleteBatchIds
2025-09-15 19:50:18.718 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.update
2025-09-15 19:50:18.718 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.updateById
2025-09-15 19:50:18.718 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.selectById
2025-09-15 19:50:18.719 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.selectBatchIds
2025-09-15 19:50:18.720 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.selectByMap
2025-09-15 19:50:18.721 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.selectOne
2025-09-15 19:50:18.721 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.selectCount
2025-09-15 19:50:18.722 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.selectMaps
2025-09-15 19:50:18.723 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.selectMapsPage
2025-09-15 19:50:18.724 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.selectObjs
2025-09-15 19:50:18.724 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.selectList
2025-09-15 19:50:18.725 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.selectPage
2025-09-15 19:50:18.735 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.insert
2025-09-15 19:50:18.735 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.delete
2025-09-15 19:50:18.736 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.deleteByMap
2025-09-15 19:50:18.736 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.deleteById
2025-09-15 19:50:18.737 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.deleteBatchIds
2025-09-15 19:50:18.738 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.update
2025-09-15 19:50:18.738 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.updateById
2025-09-15 19:50:18.738 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.selectById
2025-09-15 19:50:18.739 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.selectBatchIds
2025-09-15 19:50:18.739 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.selectByMap
2025-09-15 19:50:18.740 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.selectOne
2025-09-15 19:50:18.740 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.selectCount
2025-09-15 19:50:18.741 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.selectMaps
2025-09-15 19:50:18.743 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.selectMapsPage
2025-09-15 19:50:18.743 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.selectObjs
2025-09-15 19:50:18.744 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.selectList
2025-09-15 19:50:18.744 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.selectPage
2025-09-15 19:50:18.750 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.insert
2025-09-15 19:50:18.751 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.delete
2025-09-15 19:50:18.752 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.deleteByMap
2025-09-15 19:50:18.752 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.deleteById
2025-09-15 19:50:18.752 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.deleteBatchIds
2025-09-15 19:50:18.753 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.update
2025-09-15 19:50:18.753 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.updateById
2025-09-15 19:50:18.754 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.selectById
2025-09-15 19:50:18.754 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.selectBatchIds
2025-09-15 19:50:18.755 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.selectByMap
2025-09-15 19:50:18.756 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.selectOne
2025-09-15 19:50:18.756 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.selectCount
2025-09-15 19:50:18.757 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.selectMaps
2025-09-15 19:50:18.758 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.selectMapsPage
2025-09-15 19:50:18.758 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.selectObjs
2025-09-15 19:50:18.759 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.selectList
2025-09-15 19:50:18.760 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.selectPage
2025-09-15 19:50:18.768 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.insert
2025-09-15 19:50:18.768 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.delete
2025-09-15 19:50:18.769 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.deleteByMap
2025-09-15 19:50:18.770 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.deleteById
2025-09-15 19:50:18.771 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.deleteBatchIds
2025-09-15 19:50:18.772 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.update
2025-09-15 19:50:18.773 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.updateById
2025-09-15 19:50:18.773 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.selectById
2025-09-15 19:50:18.773 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.selectBatchIds
2025-09-15 19:50:18.774 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.selectByMap
2025-09-15 19:50:18.775 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.selectOne
2025-09-15 19:50:18.775 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.selectCount
2025-09-15 19:50:18.776 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.selectMaps
2025-09-15 19:50:18.776 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.selectMapsPage
2025-09-15 19:50:18.777 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.selectObjs
2025-09-15 19:50:18.777 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.selectList
2025-09-15 19:50:18.778 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.selectPage
2025-09-15 19:50:18.783 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.findCateIdsByReserveId
2025-09-15 19:50:18.783 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.findReserveIdsByCateId
2025-09-15 19:50:18.783 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.insert
2025-09-15 19:50:18.785 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.delete
2025-09-15 19:50:18.785 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.deleteByMap
2025-09-15 19:50:18.786 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.deleteById
2025-09-15 19:50:18.786 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.deleteBatchIds
2025-09-15 19:50:18.786 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.update
2025-09-15 19:50:18.787 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.updateById
2025-09-15 19:50:18.787 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.selectById
2025-09-15 19:50:18.788 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.selectBatchIds
2025-09-15 19:50:18.788 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.selectByMap
2025-09-15 19:50:18.789 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.selectOne
2025-09-15 19:50:18.789 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.selectCount
2025-09-15 19:50:18.790 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.selectMaps
2025-09-15 19:50:18.791 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.selectMapsPage
2025-09-15 19:50:18.791 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.selectObjs
2025-09-15 19:50:18.793 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.selectList
2025-09-15 19:50:18.793 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.selectPage
2025-09-15 19:50:18.796 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.findByCollectionName
2025-09-15 19:50:18.797 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.insert
2025-09-15 19:50:18.798 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.delete
2025-09-15 19:50:18.798 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.deleteByMap
2025-09-15 19:50:18.799 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.deleteById
2025-09-15 19:50:18.799 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.deleteBatchIds
2025-09-15 19:50:18.800 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.update
2025-09-15 19:50:18.800 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.updateById
2025-09-15 19:50:18.800 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.selectById
2025-09-15 19:50:18.800 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.selectBatchIds
2025-09-15 19:50:18.800 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.selectByMap
2025-09-15 19:50:18.802 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.selectOne
2025-09-15 19:50:18.803 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.selectCount
2025-09-15 19:50:18.804 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.selectMaps
2025-09-15 19:50:18.805 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.selectMapsPage
2025-09-15 19:50:18.807 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.selectObjs
2025-09-15 19:50:18.808 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.selectList
2025-09-15 19:50:18.812 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.selectPage
2025-09-15 19:50:18.924 [main] INFO  com.museum.service.impl.ReserveExpirationService - 服务启动时执行预约过期检查...
2025-09-15 19:50:18.976 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-15 19:50:19.009 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8091 (http)
2025-09-15 19:50:19.016 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-15 19:50:19.016 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.80]
2025-09-15 19:50:19.141 [main] INFO  o.a.c.c.ContainerBase.[Tomcat].[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-09-15 19:50:19.141 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1202 ms
2025-09-15 19:50:19.185 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-15 19:50:19.189 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==>  Preparing: SELECT order_id,user_id,user_name,res_id,vld_stat,res_session,res_type,res_date,res_time FROM ms_reserve_detail WHERE (vld_stat = ? AND res_date < ?)
2025-09-15 19:50:19.205 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==> Parameters: 1(String), 2025-09-15(String)
2025-09-15 19:50:19.220 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - <==      Total: 0
2025-09-15 19:50:19.223 [main] INFO  com.museum.service.impl.ReserveExpirationService - 找到 0 条过期预约
2025-09-15 19:50:19.223 [main] INFO  com.museum.service.impl.ReserveExpirationService - 过期预约检查完成，共处理 0 条记录
2025-09-15 19:50:19.466 [main] DEBUG c.b.m.e.spring.MybatisSqlSessionFactoryBean - Registered plugin: 'com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor@45dc7be'
2025-09-15 19:50:19.519 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.insert
2025-09-15 19:50:19.522 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.delete
2025-09-15 19:50:19.523 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.deleteByMap
2025-09-15 19:50:19.535 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.deleteById
2025-09-15 19:50:19.537 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.deleteBatchIds
2025-09-15 19:50:19.539 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.update
2025-09-15 19:50:19.540 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.updateById
2025-09-15 19:50:19.540 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.selectById
2025-09-15 19:50:19.541 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.selectBatchIds
2025-09-15 19:50:19.541 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.selectByMap
2025-09-15 19:50:19.542 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.selectOne
2025-09-15 19:50:19.543 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.selectCount
2025-09-15 19:50:19.544 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.selectMaps
2025-09-15 19:50:19.545 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.selectMapsPage
2025-09-15 19:50:19.546 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.selectObjs
2025-09-15 19:50:19.548 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.selectList
2025-09-15 19:50:19.548 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.StudentMapper.selectPage
2025-09-15 19:50:19.549 [main] DEBUG c.b.m.e.spring.MybatisSqlSessionFactoryBean - Parsed mapper file: 'file [G:\dissertation\Bowucode\正确版本\museum_server\target\classes\mapper\StudentMapper.xml]'
2025-09-15 19:50:19.588 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.insert
2025-09-15 19:50:19.590 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.delete
2025-09-15 19:50:19.590 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.deleteByMap
2025-09-15 19:50:19.591 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.deleteById
2025-09-15 19:50:19.592 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.deleteBatchIds
2025-09-15 19:50:19.593 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.update
2025-09-15 19:50:19.593 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.updateById
2025-09-15 19:50:19.593 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.selectById
2025-09-15 19:50:19.594 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.selectBatchIds
2025-09-15 19:50:19.595 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.selectByMap
2025-09-15 19:50:19.595 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.selectOne
2025-09-15 19:50:19.596 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.selectCount
2025-09-15 19:50:19.597 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.selectMaps
2025-09-15 19:50:19.598 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.selectMapsPage
2025-09-15 19:50:19.598 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.selectObjs
2025-09-15 19:50:19.599 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.selectList
2025-09-15 19:50:19.599 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.AdminMapper.selectPage
2025-09-15 19:50:19.618 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8090 (http) with context path '/api'
2025-09-15 19:50:19.623 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.insert
2025-09-15 19:50:19.624 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.delete
2025-09-15 19:50:19.625 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.deleteByMap
2025-09-15 19:50:19.625 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.deleteById
2025-09-15 19:50:19.626 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.deleteBatchIds
2025-09-15 19:50:19.627 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.update
2025-09-15 19:50:19.628 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.updateById
2025-09-15 19:50:19.628 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.selectById
2025-09-15 19:50:19.629 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.selectBatchIds
2025-09-15 19:50:19.629 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.selectByMap
2025-09-15 19:50:19.633 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.selectOne
2025-09-15 19:50:19.633 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.selectCount
2025-09-15 19:50:19.634 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.selectMaps
2025-09-15 19:50:19.635 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.selectMapsPage
2025-09-15 19:50:19.635 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.selectObjs
2025-09-15 19:50:19.636 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.selectList
2025-09-15 19:50:19.636 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsAnnouncementMapper.selectPage
2025-09-15 19:50:19.646 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.insert
2025-09-15 19:50:19.647 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.delete
2025-09-15 19:50:19.647 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.deleteByMap
2025-09-15 19:50:19.648 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.deleteById
2025-09-15 19:50:19.649 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.deleteBatchIds
2025-09-15 19:50:19.650 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.update
2025-09-15 19:50:19.650 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.updateById
2025-09-15 19:50:19.651 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.selectById
2025-09-15 19:50:19.652 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.selectBatchIds
2025-09-15 19:50:19.652 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.selectByMap
2025-09-15 19:50:19.653 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.selectOne
2025-09-15 19:50:19.654 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.selectCount
2025-09-15 19:50:19.654 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.selectMaps
2025-09-15 19:50:19.655 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.selectMapsPage
2025-09-15 19:50:19.656 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.selectObjs
2025-09-15 19:50:19.657 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.selectList
2025-09-15 19:50:19.658 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.MsUserMapper.selectPage
2025-09-15 19:50:19.708 [main] INFO  org.redisson.Version - Redisson 3.13.6
2025-09-15 19:50:19.879 [main] INFO  com.museum.MybatisplusApplication - Started MybatisplusApplication in 3.585 seconds (JVM running for 3.97)
2025-09-15 19:50:19.869 [redisson-netty-4-16] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for /127.0.0.1:6379
2025-09-15 19:50:19.879 [redisson-netty-4-16] INFO  org.redisson.connection.pool.MasterConnectionPool - 24 connections initialized for /127.0.0.1:6379
2025-09-15 19:50:19.886 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection info: {"id":"174766d6-ffb1-4b0e-b506-6fd8e3dd7e06","name":"museum-collection","configuration_json":{"hnsw_configuration":{"space":"l2","ef_construction":100,"ef_search":10,"num_threads":24,"M":16,"resize_factor":1.2,"batch_size":1000,"sync_threshold":100,"_type":"HNSWConfigurationInternal"},"_type":"CollectionConfigurationInternal"},"metadata":{"hnsw:space":"cosine"},"dimension":null,"tenant":"default_tenant","database":"default_database","version":0}
2025-09-15 19:50:19.886 [main] INFO  com.museum.service.impl.agent.DataInitializer - 向量数据已存在，跳过初始化
2025-09-15 19:50:19.989 [main] INFO  com.museum.config.ChromaConfig - Attempting to connect to Chroma at: http://localhost:8000/
2025-09-15 19:50:20.041 [main] INFO  com.museum.config.ChromaConfig - Successfully connected to Chroma
2025-09-15 19:50:20.054 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.insert
2025-09-15 19:50:20.055 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.delete
2025-09-15 19:50:20.055 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.deleteByMap
2025-09-15 19:50:20.056 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.deleteById
2025-09-15 19:50:20.057 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.deleteBatchIds
2025-09-15 19:50:20.057 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.update
2025-09-15 19:50:20.057 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.updateById
2025-09-15 19:50:20.058 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.selectById
2025-09-15 19:50:20.058 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.selectBatchIds
2025-09-15 19:50:20.059 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.selectByMap
2025-09-15 19:50:20.059 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.selectOne
2025-09-15 19:50:20.060 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.selectCount
2025-09-15 19:50:20.061 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.selectMaps
2025-09-15 19:50:20.062 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.selectMapsPage
2025-09-15 19:50:20.062 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.selectObjs
2025-09-15 19:50:20.063 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.selectList
2025-09-15 19:50:20.064 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.CollectionMapper.selectPage
2025-09-15 19:50:20.074 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.insert
2025-09-15 19:50:20.075 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.delete
2025-09-15 19:50:20.075 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.deleteByMap
2025-09-15 19:50:20.076 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.deleteById
2025-09-15 19:50:20.077 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.deleteBatchIds
2025-09-15 19:50:20.078 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.update
2025-09-15 19:50:20.078 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.updateById
2025-09-15 19:50:20.078 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.selectById
2025-09-15 19:50:20.079 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.selectBatchIds
2025-09-15 19:50:20.080 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.selectByMap
2025-09-15 19:50:20.080 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.selectOne
2025-09-15 19:50:20.081 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.selectCount
2025-09-15 19:50:20.081 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.selectMaps
2025-09-15 19:50:20.082 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.selectMapsPage
2025-09-15 19:50:20.082 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.selectObjs
2025-09-15 19:50:20.083 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.selectList
2025-09-15 19:50:20.083 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.DicMapper.selectPage
2025-09-15 19:50:20.091 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.insert
2025-09-15 19:50:20.092 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.delete
2025-09-15 19:50:20.092 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.deleteByMap
2025-09-15 19:50:20.093 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.deleteById
2025-09-15 19:50:20.093 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.deleteBatchIds
2025-09-15 19:50:20.093 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.update
2025-09-15 19:50:20.094 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.updateById
2025-09-15 19:50:20.094 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.selectById
2025-09-15 19:50:20.095 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.selectBatchIds
2025-09-15 19:50:20.095 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.selectByMap
2025-09-15 19:50:20.100 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.selectOne
2025-09-15 19:50:20.101 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.selectCount
2025-09-15 19:50:20.101 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.selectMaps
2025-09-15 19:50:20.101 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.selectMapsPage
2025-09-15 19:50:20.102 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.selectObjs
2025-09-15 19:50:20.103 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.selectList
2025-09-15 19:50:20.103 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.FeedBackMapper.selectPage
2025-09-15 19:50:20.111 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.insert
2025-09-15 19:50:20.111 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.delete
2025-09-15 19:50:20.112 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.deleteByMap
2025-09-15 19:50:20.112 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.deleteById
2025-09-15 19:50:20.113 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.deleteBatchIds
2025-09-15 19:50:20.113 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.update
2025-09-15 19:50:20.114 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.updateById
2025-09-15 19:50:20.114 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.selectById
2025-09-15 19:50:20.115 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.selectBatchIds
2025-09-15 19:50:20.116 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.selectByMap
2025-09-15 19:50:20.116 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.selectOne
2025-09-15 19:50:20.117 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.selectCount
2025-09-15 19:50:20.117 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.selectMaps
2025-09-15 19:50:20.118 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.selectMapsPage
2025-09-15 19:50:20.118 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.selectObjs
2025-09-15 19:50:20.119 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.selectList
2025-09-15 19:50:20.120 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveDetialMapper.selectPage
2025-09-15 19:50:20.123 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.findCateIdsByReserveId
2025-09-15 19:50:20.123 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.findReserveIdsByCateId
2025-09-15 19:50:20.124 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.insert
2025-09-15 19:50:20.124 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.delete
2025-09-15 19:50:20.124 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.deleteByMap
2025-09-15 19:50:20.126 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.deleteById
2025-09-15 19:50:20.126 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.deleteBatchIds
2025-09-15 19:50:20.127 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.update
2025-09-15 19:50:20.127 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.updateById
2025-09-15 19:50:20.127 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.selectById
2025-09-15 19:50:20.127 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.selectBatchIds
2025-09-15 19:50:20.128 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.selectByMap
2025-09-15 19:50:20.128 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.selectOne
2025-09-15 19:50:20.129 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.selectCount
2025-09-15 19:50:20.129 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.selectMaps
2025-09-15 19:50:20.130 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.selectMapsPage
2025-09-15 19:50:20.130 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.selectObjs
2025-09-15 19:50:20.130 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.selectList
2025-09-15 19:50:20.131 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveCollectionMapper.selectPage
2025-09-15 19:50:20.133 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.findByCollectionName
2025-09-15 19:50:20.134 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.insert
2025-09-15 19:50:20.134 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.delete
2025-09-15 19:50:20.134 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.deleteByMap
2025-09-15 19:50:20.135 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.deleteById
2025-09-15 19:50:20.135 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.deleteBatchIds
2025-09-15 19:50:20.136 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.update
2025-09-15 19:50:20.136 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.updateById
2025-09-15 19:50:20.136 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.selectById
2025-09-15 19:50:20.137 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.selectBatchIds
2025-09-15 19:50:20.137 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.selectByMap
2025-09-15 19:50:20.138 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.selectOne
2025-09-15 19:50:20.138 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.selectCount
2025-09-15 19:50:20.139 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.selectMaps
2025-09-15 19:50:20.139 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.selectMapsPage
2025-09-15 19:50:20.140 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.selectObjs
2025-09-15 19:50:20.140 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.selectList
2025-09-15 19:50:20.141 [main] DEBUG com.baomidou.mybatisplus.core.MybatisConfiguration - addMappedStatement: com.museum.mapper.ReserveMapper.selectPage
2025-09-15 19:50:20.197 [main] INFO  com.museum.service.impl.ReserveExpirationService - 服务启动时执行预约过期检查...
2025-09-15 19:50:20.236 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-15 19:50:20.409 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-15 19:50:20.413 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==>  Preparing: SELECT order_id,user_id,user_name,res_id,vld_stat,res_session,res_type,res_date,res_time FROM ms_reserve_detail WHERE (vld_stat = ? AND res_date < ?)
2025-09-15 19:50:20.430 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==> Parameters: 1(String), 2025-09-15(String)
2025-09-15 19:50:20.442 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - <==      Total: 0
2025-09-15 19:50:20.445 [main] INFO  com.museum.service.impl.ReserveExpirationService - 找到 0 条过期预约
2025-09-15 19:50:20.445 [main] INFO  com.museum.service.impl.ReserveExpirationService - 过期预约检查完成，共处理 0 条记录
2025-09-15 19:50:20.801 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8091 (http) with context path '/api'
2025-09-15 19:50:21.074 [main] INFO  com.museum.MybatisplusApplication - Started MybatisplusApplication in 3.412 seconds (JVM running for 3.85)
2025-09-15 19:50:21.081 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection info: {"id":"174766d6-ffb1-4b0e-b506-6fd8e3dd7e06","name":"museum-collection","configuration_json":{"hnsw_configuration":{"space":"l2","ef_construction":100,"ef_search":10,"num_threads":24,"M":16,"resize_factor":1.2,"batch_size":1000,"sync_threshold":100,"_type":"HNSWConfigurationInternal"},"_type":"CollectionConfigurationInternal"},"metadata":{"hnsw:space":"cosine"},"dimension":null,"tenant":"default_tenant","database":"default_database","version":0}
2025-09-15 19:50:21.081 [main] INFO  com.museum.service.impl.agent.DataInitializer - 向量数据已存在，跳过初始化
2025-09-15 19:52:20.439 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-15 19:52:20.444 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-15 19:52:20.447 [pool-4-thread-1] WARN  io.lettuce.core.RedisChannelHandler - Connection is already closed
2025-09-15 19:52:20.451 [pool-4-thread-1] DEBUG com.museum.service.impl.ReserveOrderAsyncService - 处理预约订单异常
org.springframework.data.redis.RedisSystemException: Redis exception; nested exception is io.lettuce.core.RedisException: Connection closed
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:74)
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:41)
	at org.springframework.data.redis.PassThroughExceptionTranslationStrategy.translate(PassThroughExceptionTranslationStrategy.java:44)
	at org.springframework.data.redis.FallbackExceptionTranslationStrategy.translate(FallbackExceptionTranslationStrategy.java:42)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.convertLettuceAccessException(LettuceConnection.java:272)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.await(LettuceConnection.java:1063)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.lambda$doInvoke$4(LettuceConnection.java:920)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$Synchronizer.invoke(LettuceInvoker.java:673)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$DefaultManyInvocationSpec.toList(LettuceInvoker.java:618)
	at org.springframework.data.redis.connection.lettuce.LettuceStreamCommands.xReadGroup(LettuceStreamCommands.java:350)
	at org.springframework.data.redis.connection.DefaultedRedisConnection.xReadGroup(DefaultedRedisConnection.java:617)
	at org.springframework.data.redis.connection.DefaultStringRedisConnection.xReadGroup(DefaultStringRedisConnection.java:4795)
	at org.springframework.data.redis.core.DefaultStreamOperations$4.inRedis(DefaultStreamOperations.java:310)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:387)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:382)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:223)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:120)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisException: Connection closed
	at io.lettuce.core.protocol.DefaultEndpoint.notifyDrainQueuedCommands(DefaultEndpoint.java:679)
	at io.lettuce.core.protocol.CommandHandler.channelInactive(CommandHandler.java:358)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.protocol.RedisHandshakeHandler.channelInactive(RedisHandshakeHandler.java:89)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.ChannelGroupListener.channelInactive(ChannelGroupListener.java:69)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 19:52:20.463 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-15 19:52:20.469 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-15 19:52:20.473 [pool-4-thread-1] WARN  io.lettuce.core.RedisChannelHandler - Connection is already closed
2025-09-15 19:52:20.476 [pool-4-thread-1] DEBUG com.museum.service.impl.ReserveOrderAsyncService - 处理预约订单异常
org.springframework.data.redis.RedisSystemException: Redis exception; nested exception is io.lettuce.core.RedisException: Connection closed
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:74)
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:41)
	at org.springframework.data.redis.PassThroughExceptionTranslationStrategy.translate(PassThroughExceptionTranslationStrategy.java:44)
	at org.springframework.data.redis.FallbackExceptionTranslationStrategy.translate(FallbackExceptionTranslationStrategy.java:42)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.convertLettuceAccessException(LettuceConnection.java:272)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.await(LettuceConnection.java:1063)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.lambda$doInvoke$4(LettuceConnection.java:920)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$Synchronizer.invoke(LettuceInvoker.java:673)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$DefaultManyInvocationSpec.toList(LettuceInvoker.java:618)
	at org.springframework.data.redis.connection.lettuce.LettuceStreamCommands.xReadGroup(LettuceStreamCommands.java:350)
	at org.springframework.data.redis.connection.DefaultedRedisConnection.xReadGroup(DefaultedRedisConnection.java:617)
	at org.springframework.data.redis.connection.DefaultStringRedisConnection.xReadGroup(DefaultStringRedisConnection.java:4795)
	at org.springframework.data.redis.core.DefaultStreamOperations$4.inRedis(DefaultStreamOperations.java:310)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:387)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:382)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:223)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:120)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisException: Connection closed
	at io.lettuce.core.protocol.DefaultEndpoint.notifyDrainQueuedCommands(DefaultEndpoint.java:679)
	at io.lettuce.core.protocol.CommandHandler.channelInactive(CommandHandler.java:358)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.protocol.RedisHandshakeHandler.channelInactive(RedisHandshakeHandler.java:89)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.ChannelGroupListener.channelInactive(ChannelGroupListener.java:69)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 19:52:20.558 [pool-4-thread-1] ERROR com.museum.service.impl.ReserveOrderAsyncService - 处理Pending-list出现系统异常
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1689)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1597)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1383)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1366)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1093)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:421)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:193)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:144)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:105)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:210)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.handlePendingList(ReserveOrderAsyncService.java:150)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:142)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:330)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:216)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:115)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:115)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1595)
	... 18 common frames omitted
Caused by: java.lang.IllegalStateException: executor not accepting a task
	at io.netty.resolver.AddressResolverGroup.getResolver(AddressResolverGroup.java:61)
	at io.netty.bootstrap.Bootstrap.doResolveAndConnect0(Bootstrap.java:208)
	at io.netty.bootstrap.Bootstrap.access$000(Bootstrap.java:46)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:189)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:175)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:590)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:557)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:492)
	at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:636)
	at io.netty.util.concurrent.DefaultPromise.setSuccess0(DefaultPromise.java:625)
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:105)
	at io.netty.channel.DefaultChannelPromise.trySuccess(DefaultChannelPromise.java:84)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetSuccess(AbstractChannel.java:990)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.register0(AbstractChannel.java:516)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.access$200(AbstractChannel.java:429)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$1.run(AbstractChannel.java:486)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 19:52:20.589 [pool-4-thread-1] ERROR com.museum.service.impl.ReserveOrderAsyncService - 处理Pending-list出现系统异常
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1689)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1597)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1383)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1366)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1093)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:421)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:193)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:144)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:105)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:210)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.handlePendingList(ReserveOrderAsyncService.java:150)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:142)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:330)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:216)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:115)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:115)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1595)
	... 18 common frames omitted
Caused by: java.lang.IllegalStateException: executor not accepting a task
	at io.netty.resolver.AddressResolverGroup.getResolver(AddressResolverGroup.java:61)
	at io.netty.bootstrap.Bootstrap.doResolveAndConnect0(Bootstrap.java:208)
	at io.netty.bootstrap.Bootstrap.access$000(Bootstrap.java:46)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:189)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:175)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:590)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:557)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:492)
	at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:636)
	at io.netty.util.concurrent.DefaultPromise.setSuccess0(DefaultPromise.java:625)
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:105)
	at io.netty.channel.DefaultChannelPromise.trySuccess(DefaultChannelPromise.java:84)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetSuccess(AbstractChannel.java:990)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.register0(AbstractChannel.java:516)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.access$200(AbstractChannel.java:429)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$1.run(AbstractChannel.java:486)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 19:52:23.466 [main] INFO  com.museum.MybatisplusApplication - Starting MybatisplusApplication using Java 17.0.14 on thinkmacbook with PID 3908 (G:\dissertation\Bowucode\正确版本\museum_server\target\classes started by Ezekiel in G:\dissertation\Bowucode\正确版本\museum_server)
2025-09-15 19:52:23.467 [main] DEBUG com.museum.MybatisplusApplication - Running with Spring Boot v2.7.16, Spring v5.3.30
2025-09-15 19:52:23.467 [main] INFO  com.museum.MybatisplusApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-15 19:52:23.962 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-15 19:52:23.964 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-15 19:52:23.981 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-09-15 19:52:24.400 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8090 (http)
2025-09-15 19:52:24.405 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-15 19:52:24.405 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.80]
2025-09-15 19:52:24.509 [main] INFO  o.a.c.c.ContainerBase.[Tomcat].[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-09-15 19:52:24.510 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1012 ms
2025-09-15 19:52:24.713 [main] INFO  com.museum.MybatisplusApplication - Starting MybatisplusApplication using Java 17.0.14 on thinkmacbook with PID 25892 (G:\dissertation\Bowucode\正确版本\museum_server\target\classes started by Ezekiel in G:\dissertation\Bowucode\正确版本\museum_server)
2025-09-15 19:52:24.715 [main] DEBUG com.museum.MybatisplusApplication - Running with Spring Boot v2.7.16, Spring v5.3.30
2025-09-15 19:52:24.715 [main] INFO  com.museum.MybatisplusApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-15 19:52:25.032 [main] INFO  org.redisson.Version - Redisson 3.13.6
2025-09-15 19:52:25.186 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-15 19:52:25.187 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-15 19:52:25.195 [redisson-netty-4-17] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for /127.0.0.1:6379
2025-09-15 19:52:25.204 [redisson-netty-4-19] INFO  org.redisson.connection.pool.MasterConnectionPool - 24 connections initialized for /127.0.0.1:6379
2025-09-15 19:52:25.206 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-09-15 19:52:25.316 [main] INFO  com.museum.config.ChromaConfig - Attempting to connect to Chroma at: http://localhost:8000/
2025-09-15 19:52:25.444 [main] INFO  com.museum.config.ChromaConfig - Successfully connected to Chroma
2025-09-15 19:52:25.589 [main] INFO  com.museum.service.impl.ReserveExpirationService - 服务启动时执行预约过期检查...
2025-09-15 19:52:25.615 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8091 (http)
2025-09-15 19:52:25.622 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-15 19:52:25.622 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.80]
2025-09-15 19:52:25.629 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-15 19:52:25.752 [main] INFO  o.a.c.c.ContainerBase.[Tomcat].[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-09-15 19:52:25.752 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1001 ms
2025-09-15 19:52:25.815 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-15 19:52:25.818 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==>  Preparing: SELECT order_id,user_id,user_name,res_id,vld_stat,res_session,res_type,res_date,res_time FROM ms_reserve_detail WHERE (vld_stat = ? AND res_date < ?)
2025-09-15 19:52:25.834 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==> Parameters: 1(String), 2025-09-15(String)
2025-09-15 19:52:25.846 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - <==      Total: 0
2025-09-15 19:52:25.849 [main] INFO  com.museum.service.impl.ReserveExpirationService - 找到 0 条过期预约
2025-09-15 19:52:25.849 [main] INFO  com.museum.service.impl.ReserveExpirationService - 过期预约检查完成，共处理 0 条记录
2025-09-15 19:52:26.240 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8090 (http) with context path '/api'
2025-09-15 19:52:26.296 [main] INFO  org.redisson.Version - Redisson 3.13.6
2025-09-15 19:52:26.452 [redisson-netty-4-16] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for /127.0.0.1:6379
2025-09-15 19:52:26.460 [redisson-netty-4-18] INFO  org.redisson.connection.pool.MasterConnectionPool - 24 connections initialized for /127.0.0.1:6379
2025-09-15 19:52:26.483 [main] INFO  com.museum.MybatisplusApplication - Started MybatisplusApplication in 3.238 seconds (JVM running for 3.635)
2025-09-15 19:52:26.490 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection info: {"id":"e4ebff0e-9e16-4a01-811e-1e54c1141da3","name":"museum-collection","configuration_json":{"hnsw_configuration":{"space":"l2","ef_construction":100,"ef_search":10,"num_threads":24,"M":16,"resize_factor":1.2,"batch_size":1000,"sync_threshold":100,"_type":"HNSWConfigurationInternal"},"_type":"CollectionConfigurationInternal"},"metadata":{"hnsw:space":"cosine"},"dimension":null,"tenant":"default_tenant","database":"default_database","version":0}
2025-09-15 19:52:26.490 [main] INFO  com.museum.service.impl.agent.DataInitializer - 向量数据已存在，跳过初始化
2025-09-15 19:52:26.560 [main] INFO  com.museum.config.ChromaConfig - Attempting to connect to Chroma at: http://localhost:8000/
2025-09-15 19:52:26.616 [main] INFO  com.museum.config.ChromaConfig - Successfully connected to Chroma
2025-09-15 19:52:26.761 [main] INFO  com.museum.service.impl.ReserveExpirationService - 服务启动时执行预约过期检查...
2025-09-15 19:52:26.798 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-15 19:52:26.976 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-15 19:52:26.980 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==>  Preparing: SELECT order_id,user_id,user_name,res_id,vld_stat,res_session,res_type,res_date,res_time FROM ms_reserve_detail WHERE (vld_stat = ? AND res_date < ?)
2025-09-15 19:52:26.996 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==> Parameters: 1(String), 2025-09-15(String)
2025-09-15 19:52:27.009 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - <==      Total: 0
2025-09-15 19:52:27.011 [main] INFO  com.museum.service.impl.ReserveExpirationService - 找到 0 条过期预约
2025-09-15 19:52:27.011 [main] INFO  com.museum.service.impl.ReserveExpirationService - 过期预约检查完成，共处理 0 条记录
2025-09-15 19:52:27.378 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8091 (http) with context path '/api'
2025-09-15 19:52:27.616 [main] INFO  com.museum.MybatisplusApplication - Started MybatisplusApplication in 3.127 seconds (JVM running for 3.537)
2025-09-15 19:52:27.624 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection info: {"id":"e4ebff0e-9e16-4a01-811e-1e54c1141da3","name":"museum-collection","configuration_json":{"hnsw_configuration":{"space":"l2","ef_construction":100,"ef_search":10,"num_threads":24,"M":16,"resize_factor":1.2,"batch_size":1000,"sync_threshold":100,"_type":"HNSWConfigurationInternal"},"_type":"CollectionConfigurationInternal"},"metadata":{"hnsw:space":"cosine"},"dimension":null,"tenant":"default_tenant","database":"default_database","version":0}
2025-09-15 19:52:27.624 [main] INFO  com.museum.service.impl.agent.DataInitializer - 向量数据已存在，跳过初始化
2025-09-15 20:26:54.553 [HikariPool-1 housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=25m58s582ms511µs100ns).
2025-09-15 20:26:55.729 [HikariPool-1 housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=25m58s580ms745µs800ns).
2025-09-15 20:28:52.958 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-15 20:28:52.961 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-15 20:28:52.963 [pool-4-thread-1] WARN  io.lettuce.core.RedisChannelHandler - Connection is already closed
2025-09-15 20:28:52.969 [pool-4-thread-1] DEBUG com.museum.service.impl.ReserveOrderAsyncService - 处理预约订单异常
org.springframework.data.redis.RedisSystemException: Redis exception; nested exception is io.lettuce.core.RedisException: Connection closed
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:74)
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:41)
	at org.springframework.data.redis.PassThroughExceptionTranslationStrategy.translate(PassThroughExceptionTranslationStrategy.java:44)
	at org.springframework.data.redis.FallbackExceptionTranslationStrategy.translate(FallbackExceptionTranslationStrategy.java:42)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.convertLettuceAccessException(LettuceConnection.java:272)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.await(LettuceConnection.java:1063)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.lambda$doInvoke$4(LettuceConnection.java:920)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$Synchronizer.invoke(LettuceInvoker.java:673)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$DefaultManyInvocationSpec.toList(LettuceInvoker.java:618)
	at org.springframework.data.redis.connection.lettuce.LettuceStreamCommands.xReadGroup(LettuceStreamCommands.java:350)
	at org.springframework.data.redis.connection.DefaultedRedisConnection.xReadGroup(DefaultedRedisConnection.java:617)
	at org.springframework.data.redis.connection.DefaultStringRedisConnection.xReadGroup(DefaultStringRedisConnection.java:4795)
	at org.springframework.data.redis.core.DefaultStreamOperations$4.inRedis(DefaultStreamOperations.java:310)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:387)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:382)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:223)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:120)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisException: Connection closed
	at io.lettuce.core.protocol.DefaultEndpoint.notifyDrainQueuedCommands(DefaultEndpoint.java:679)
	at io.lettuce.core.protocol.CommandHandler.channelInactive(CommandHandler.java:358)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.protocol.RedisHandshakeHandler.channelInactive(RedisHandshakeHandler.java:89)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.ChannelGroupListener.channelInactive(ChannelGroupListener.java:69)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 20:28:52.978 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-15 20:28:52.981 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-15 20:28:52.983 [pool-4-thread-1] WARN  io.lettuce.core.RedisChannelHandler - Connection is already closed
2025-09-15 20:28:52.988 [pool-4-thread-1] DEBUG com.museum.service.impl.ReserveOrderAsyncService - 处理预约订单异常
org.springframework.data.redis.RedisSystemException: Redis exception; nested exception is io.lettuce.core.RedisException: Connection closed
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:74)
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:41)
	at org.springframework.data.redis.PassThroughExceptionTranslationStrategy.translate(PassThroughExceptionTranslationStrategy.java:44)
	at org.springframework.data.redis.FallbackExceptionTranslationStrategy.translate(FallbackExceptionTranslationStrategy.java:42)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.convertLettuceAccessException(LettuceConnection.java:272)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.await(LettuceConnection.java:1063)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.lambda$doInvoke$4(LettuceConnection.java:920)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$Synchronizer.invoke(LettuceInvoker.java:673)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$DefaultManyInvocationSpec.toList(LettuceInvoker.java:618)
	at org.springframework.data.redis.connection.lettuce.LettuceStreamCommands.xReadGroup(LettuceStreamCommands.java:350)
	at org.springframework.data.redis.connection.DefaultedRedisConnection.xReadGroup(DefaultedRedisConnection.java:617)
	at org.springframework.data.redis.connection.DefaultStringRedisConnection.xReadGroup(DefaultStringRedisConnection.java:4795)
	at org.springframework.data.redis.core.DefaultStreamOperations$4.inRedis(DefaultStreamOperations.java:310)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:387)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:382)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:223)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:120)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisException: Connection closed
	at io.lettuce.core.protocol.DefaultEndpoint.notifyDrainQueuedCommands(DefaultEndpoint.java:679)
	at io.lettuce.core.protocol.CommandHandler.channelInactive(CommandHandler.java:358)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.protocol.RedisHandshakeHandler.channelInactive(RedisHandshakeHandler.java:89)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.ChannelGroupListener.channelInactive(ChannelGroupListener.java:69)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 20:28:53.074 [pool-4-thread-1] ERROR com.museum.service.impl.ReserveOrderAsyncService - 处理Pending-list出现系统异常
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1689)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1597)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1383)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1366)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1093)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:421)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:193)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:144)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:105)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:210)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.handlePendingList(ReserveOrderAsyncService.java:150)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:142)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:330)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:216)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:115)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:115)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1595)
	... 18 common frames omitted
Caused by: java.lang.IllegalStateException: executor not accepting a task
	at io.netty.resolver.AddressResolverGroup.getResolver(AddressResolverGroup.java:61)
	at io.netty.bootstrap.Bootstrap.doResolveAndConnect0(Bootstrap.java:208)
	at io.netty.bootstrap.Bootstrap.access$000(Bootstrap.java:46)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:189)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:175)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:590)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:557)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:492)
	at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:636)
	at io.netty.util.concurrent.DefaultPromise.setSuccess0(DefaultPromise.java:625)
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:105)
	at io.netty.channel.DefaultChannelPromise.trySuccess(DefaultChannelPromise.java:84)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetSuccess(AbstractChannel.java:990)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.register0(AbstractChannel.java:516)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.access$200(AbstractChannel.java:429)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$1.run(AbstractChannel.java:486)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 20:28:53.089 [pool-4-thread-1] ERROR com.museum.service.impl.ReserveOrderAsyncService - 处理Pending-list出现系统异常
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1689)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1597)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1383)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1366)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1093)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:421)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:193)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:144)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:105)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:210)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.handlePendingList(ReserveOrderAsyncService.java:150)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:142)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:330)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:216)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:115)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:115)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1595)
	... 18 common frames omitted
Caused by: java.lang.IllegalStateException: executor not accepting a task
	at io.netty.resolver.AddressResolverGroup.getResolver(AddressResolverGroup.java:61)
	at io.netty.bootstrap.Bootstrap.doResolveAndConnect0(Bootstrap.java:208)
	at io.netty.bootstrap.Bootstrap.access$000(Bootstrap.java:46)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:189)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:175)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:590)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:557)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:492)
	at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:636)
	at io.netty.util.concurrent.DefaultPromise.setSuccess0(DefaultPromise.java:625)
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:105)
	at io.netty.channel.DefaultChannelPromise.trySuccess(DefaultChannelPromise.java:84)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetSuccess(AbstractChannel.java:990)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.register0(AbstractChannel.java:516)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.access$200(AbstractChannel.java:429)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$1.run(AbstractChannel.java:486)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 20:28:57.964 [main] INFO  com.museum.MybatisplusApplication - Starting MybatisplusApplication using Java 17.0.14 on thinkmacbook with PID 43056 (G:\dissertation\Bowucode\正确版本\museum_server\target\classes started by Ezekiel in G:\dissertation\Bowucode\正确版本\museum_server)
2025-09-15 20:28:57.966 [main] DEBUG com.museum.MybatisplusApplication - Running with Spring Boot v2.7.16, Spring v5.3.30
2025-09-15 20:28:57.966 [main] INFO  com.museum.MybatisplusApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-15 20:28:58.452 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-15 20:28:58.454 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-15 20:28:58.471 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-09-15 20:28:58.937 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8090 (http)
2025-09-15 20:28:58.943 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-15 20:28:58.943 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.80]
2025-09-15 20:28:59.059 [main] INFO  o.a.c.c.ContainerBase.[Tomcat].[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-09-15 20:28:59.060 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1061 ms
2025-09-15 20:28:59.310 [main] INFO  com.museum.MybatisplusApplication - Starting MybatisplusApplication using Java 17.0.14 on thinkmacbook with PID 59460 (G:\dissertation\Bowucode\正确版本\museum_server\target\classes started by Ezekiel in G:\dissertation\Bowucode\正确版本\museum_server)
2025-09-15 20:28:59.311 [main] DEBUG com.museum.MybatisplusApplication - Running with Spring Boot v2.7.16, Spring v5.3.30
2025-09-15 20:28:59.312 [main] INFO  com.museum.MybatisplusApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-15 20:28:59.611 [main] INFO  org.redisson.Version - Redisson 3.13.6
2025-09-15 20:28:59.773 [redisson-netty-4-13] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for /127.0.0.1:6379
2025-09-15 20:28:59.782 [redisson-netty-4-19] INFO  org.redisson.connection.pool.MasterConnectionPool - 24 connections initialized for /127.0.0.1:6379
2025-09-15 20:28:59.793 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-15 20:28:59.794 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-15 20:28:59.810 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-09-15 20:28:59.893 [main] INFO  com.museum.config.ChromaConfig - Attempting to connect to Chroma at: http://localhost:8000/
2025-09-15 20:28:59.963 [main] INFO  com.museum.config.ChromaConfig - Successfully connected to Chroma
2025-09-15 20:29:00.117 [main] INFO  com.museum.service.impl.ReserveExpirationService - 服务启动时执行预约过期检查...
2025-09-15 20:29:00.153 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-15 20:29:00.232 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8091 (http)
2025-09-15 20:29:00.237 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-15 20:29:00.237 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.80]
2025-09-15 20:29:00.346 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-15 20:29:00.349 [main] INFO  o.a.c.c.ContainerBase.[Tomcat].[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-09-15 20:29:00.349 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==>  Preparing: SELECT order_id,user_id,user_name,res_id,vld_stat,res_session,res_type,res_date,res_time FROM ms_reserve_detail WHERE (vld_stat = ? AND res_date < ?)
2025-09-15 20:29:00.350 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1008 ms
2025-09-15 20:29:00.366 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==> Parameters: 1(String), 2025-09-15(String)
2025-09-15 20:29:00.379 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - <==      Total: 0
2025-09-15 20:29:00.382 [main] INFO  com.museum.service.impl.ReserveExpirationService - 找到 0 条过期预约
2025-09-15 20:29:00.382 [main] INFO  com.museum.service.impl.ReserveExpirationService - 过期预约检查完成，共处理 0 条记录
2025-09-15 20:29:00.793 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8090 (http) with context path '/api'
2025-09-15 20:29:00.904 [main] INFO  org.redisson.Version - Redisson 3.13.6
2025-09-15 20:29:01.045 [main] INFO  com.museum.MybatisplusApplication - Started MybatisplusApplication in 3.302 seconds (JVM running for 3.697)
2025-09-15 20:29:01.051 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 无法确定向量数据库状态，将重新初始化
2025-09-15 20:29:01.051 [main] INFO  com.museum.service.impl.agent.DataInitializer - 开始初始化向量数据...
2025-09-15 20:29:01.051 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 开始同步所有藏品到向量数据库...
2025-09-15 20:29:01.055 [main] WARN  com.museum.service.impl.agent.VectorSyncService - 清空 Chroma 集合失败，状态码: 400
2025-09-15 20:29:01.056 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - ==>  Preparing: SELECT id,title,origin,cate_id,des_coll,col_pic,base,display_room,crt_tm,view_cnt FROM ms_collection
2025-09-15 20:29:01.056 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - ==> Parameters: 
2025-09-15 20:29:01.059 [redisson-netty-4-13] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for /127.0.0.1:6379
2025-09-15 20:29:01.060 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - <==      Total: 9
2025-09-15 20:29:01.068 [redisson-netty-4-19] INFO  org.redisson.connection.pool.MasterConnectionPool - 24 connections initialized for /127.0.0.1:6379
2025-09-15 20:29:01.176 [main] INFO  com.museum.config.ChromaConfig - Attempting to connect to Chroma at: http://localhost:8000/
2025-09-15 20:29:01.238 [main] INFO  com.museum.config.ChromaConfig - Successfully connected to Chroma
2025-09-15 20:29:01.388 [main] INFO  com.museum.service.impl.ReserveExpirationService - 服务启动时执行预约过期检查...
2025-09-15 20:29:01.426 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-15 20:29:01.517 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 殷墟·夔纹卜骨
2025-09-15 20:29:01.603 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-15 20:29:01.606 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==>  Preparing: SELECT order_id,user_id,user_name,res_id,vld_stat,res_session,res_type,res_date,res_time FROM ms_reserve_detail WHERE (vld_stat = ? AND res_date < ?)
2025-09-15 20:29:01.621 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==> Parameters: 1(String), 2025-09-15(String)
2025-09-15 20:29:01.633 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - <==      Total: 0
2025-09-15 20:29:01.635 [main] INFO  com.museum.service.impl.ReserveExpirationService - 找到 0 条过期预约
2025-09-15 20:29:01.635 [main] INFO  com.museum.service.impl.ReserveExpirationService - 过期预约检查完成，共处理 0 条记录
2025-09-15 20:29:01.735 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 钧窑天青盏
2025-09-15 20:29:01.941 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 璇玑陶楼
2025-09-15 20:29:02.036 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8091 (http) with context path '/api'
2025-09-15 20:29:02.124 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 香妃链
2025-09-15 20:29:02.273 [main] INFO  com.museum.MybatisplusApplication - Started MybatisplusApplication in 3.2 seconds (JVM running for 3.628)
2025-09-15 20:29:02.278 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 无法确定向量数据库状态，将重新初始化
2025-09-15 20:29:02.278 [main] INFO  com.museum.service.impl.agent.DataInitializer - 开始初始化向量数据...
2025-09-15 20:29:02.278 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 开始同步所有藏品到向量数据库...
2025-09-15 20:29:02.280 [main] WARN  com.museum.service.impl.agent.VectorSyncService - 清空 Chroma 集合失败，状态码: 400
2025-09-15 20:29:02.281 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - ==>  Preparing: SELECT id,title,origin,cate_id,des_coll,col_pic,base,display_room,crt_tm,view_cnt FROM ms_collection
2025-09-15 20:29:02.282 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - ==> Parameters: 
2025-09-15 20:29:02.286 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - <==      Total: 9
2025-09-15 20:29:02.397 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 霓裳经变图
2025-09-15 20:29:02.602 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 鹤影澄泥砚
2025-09-15 20:29:02.766 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 殷墟·夔纹卜骨
2025-09-15 20:29:02.806 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 长信夔凤镜
2025-09-15 20:29:02.959 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 钧窑天青盏
2025-09-15 20:29:03.023 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 虺龙璇玑璧
2025-09-15 20:29:03.158 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 璇玑陶楼
2025-09-15 20:29:03.194 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 玄奘九环锡杖
2025-09-15 20:29:03.195 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 成功同步 9 个藏品到向量数据库
2025-09-15 20:29:03.195 [main] INFO  com.museum.service.impl.agent.DataInitializer - 向量数据初始化完成
2025-09-15 20:29:03.380 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 香妃链
2025-09-15 20:29:03.700 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 霓裳经变图
2025-09-15 20:29:03.901 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 鹤影澄泥砚
2025-09-15 20:29:04.088 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 长信夔凤镜
2025-09-15 20:29:04.302 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 虺龙璇玑璧
2025-09-15 20:29:04.524 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 玄奘九环锡杖
2025-09-15 20:29:04.524 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 成功同步 9 个藏品到向量数据库
2025-09-15 20:29:04.524 [main] INFO  com.museum.service.impl.agent.DataInitializer - 向量数据初始化完成
2025-09-15 20:49:24.010 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-15 20:49:24.015 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-15 20:49:24.017 [pool-4-thread-1] WARN  io.lettuce.core.RedisChannelHandler - Connection is already closed
2025-09-15 20:49:24.018 [pool-4-thread-1] DEBUG com.museum.service.impl.ReserveOrderAsyncService - 处理预约订单异常
org.springframework.data.redis.RedisSystemException: Redis exception; nested exception is io.lettuce.core.RedisException: Connection closed
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:74)
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:41)
	at org.springframework.data.redis.PassThroughExceptionTranslationStrategy.translate(PassThroughExceptionTranslationStrategy.java:44)
	at org.springframework.data.redis.FallbackExceptionTranslationStrategy.translate(FallbackExceptionTranslationStrategy.java:42)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.convertLettuceAccessException(LettuceConnection.java:272)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.await(LettuceConnection.java:1063)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.lambda$doInvoke$4(LettuceConnection.java:920)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$Synchronizer.invoke(LettuceInvoker.java:673)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$DefaultManyInvocationSpec.toList(LettuceInvoker.java:618)
	at org.springframework.data.redis.connection.lettuce.LettuceStreamCommands.xReadGroup(LettuceStreamCommands.java:350)
	at org.springframework.data.redis.connection.DefaultedRedisConnection.xReadGroup(DefaultedRedisConnection.java:617)
	at org.springframework.data.redis.connection.DefaultStringRedisConnection.xReadGroup(DefaultStringRedisConnection.java:4795)
	at org.springframework.data.redis.core.DefaultStreamOperations$4.inRedis(DefaultStreamOperations.java:310)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:387)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:382)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:223)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:120)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisException: Connection closed
	at io.lettuce.core.protocol.DefaultEndpoint.notifyDrainQueuedCommands(DefaultEndpoint.java:679)
	at io.lettuce.core.protocol.CommandHandler.channelInactive(CommandHandler.java:358)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.protocol.RedisHandshakeHandler.channelInactive(RedisHandshakeHandler.java:89)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.ChannelGroupListener.channelInactive(ChannelGroupListener.java:69)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 20:49:24.037 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-15 20:49:24.041 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-15 20:49:24.043 [pool-4-thread-1] WARN  io.lettuce.core.RedisChannelHandler - Connection is already closed
2025-09-15 20:49:24.045 [pool-4-thread-1] DEBUG com.museum.service.impl.ReserveOrderAsyncService - 处理预约订单异常
org.springframework.data.redis.RedisSystemException: Redis exception; nested exception is io.lettuce.core.RedisException: Connection closed
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:74)
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:41)
	at org.springframework.data.redis.PassThroughExceptionTranslationStrategy.translate(PassThroughExceptionTranslationStrategy.java:44)
	at org.springframework.data.redis.FallbackExceptionTranslationStrategy.translate(FallbackExceptionTranslationStrategy.java:42)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.convertLettuceAccessException(LettuceConnection.java:272)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.await(LettuceConnection.java:1063)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.lambda$doInvoke$4(LettuceConnection.java:920)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$Synchronizer.invoke(LettuceInvoker.java:673)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$DefaultManyInvocationSpec.toList(LettuceInvoker.java:618)
	at org.springframework.data.redis.connection.lettuce.LettuceStreamCommands.xReadGroup(LettuceStreamCommands.java:350)
	at org.springframework.data.redis.connection.DefaultedRedisConnection.xReadGroup(DefaultedRedisConnection.java:617)
	at org.springframework.data.redis.connection.DefaultStringRedisConnection.xReadGroup(DefaultStringRedisConnection.java:4795)
	at org.springframework.data.redis.core.DefaultStreamOperations$4.inRedis(DefaultStreamOperations.java:310)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:387)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:382)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:223)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:120)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisException: Connection closed
	at io.lettuce.core.protocol.DefaultEndpoint.notifyDrainQueuedCommands(DefaultEndpoint.java:679)
	at io.lettuce.core.protocol.CommandHandler.channelInactive(CommandHandler.java:358)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.protocol.RedisHandshakeHandler.channelInactive(RedisHandshakeHandler.java:89)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.ChannelGroupListener.channelInactive(ChannelGroupListener.java:69)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 20:49:24.133 [pool-4-thread-1] ERROR com.museum.service.impl.ReserveOrderAsyncService - 处理Pending-list出现系统异常
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1689)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1597)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1383)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1366)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1093)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:421)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:193)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:144)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:105)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:210)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.handlePendingList(ReserveOrderAsyncService.java:150)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:142)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:330)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:216)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:115)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:115)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1595)
	... 18 common frames omitted
Caused by: java.lang.IllegalStateException: executor not accepting a task
	at io.netty.resolver.AddressResolverGroup.getResolver(AddressResolverGroup.java:61)
	at io.netty.bootstrap.Bootstrap.doResolveAndConnect0(Bootstrap.java:208)
	at io.netty.bootstrap.Bootstrap.access$000(Bootstrap.java:46)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:189)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:175)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:590)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:557)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:492)
	at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:636)
	at io.netty.util.concurrent.DefaultPromise.setSuccess0(DefaultPromise.java:625)
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:105)
	at io.netty.channel.DefaultChannelPromise.trySuccess(DefaultChannelPromise.java:84)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetSuccess(AbstractChannel.java:990)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.register0(AbstractChannel.java:516)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.access$200(AbstractChannel.java:429)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$1.run(AbstractChannel.java:486)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 20:49:24.148 [pool-4-thread-1] ERROR com.museum.service.impl.ReserveOrderAsyncService - 处理Pending-list出现系统异常
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1689)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1597)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1383)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1366)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1093)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:421)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:193)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:144)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:105)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:210)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.handlePendingList(ReserveOrderAsyncService.java:150)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:142)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:330)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:216)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:115)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:115)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1595)
	... 18 common frames omitted
Caused by: java.lang.IllegalStateException: executor not accepting a task
	at io.netty.resolver.AddressResolverGroup.getResolver(AddressResolverGroup.java:61)
	at io.netty.bootstrap.Bootstrap.doResolveAndConnect0(Bootstrap.java:208)
	at io.netty.bootstrap.Bootstrap.access$000(Bootstrap.java:46)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:189)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:175)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:590)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:557)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:492)
	at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:636)
	at io.netty.util.concurrent.DefaultPromise.setSuccess0(DefaultPromise.java:625)
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:105)
	at io.netty.channel.DefaultChannelPromise.trySuccess(DefaultChannelPromise.java:84)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetSuccess(AbstractChannel.java:990)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.register0(AbstractChannel.java:516)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.access$200(AbstractChannel.java:429)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$1.run(AbstractChannel.java:486)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 20:49:27.786 [main] INFO  com.museum.MybatisplusApplication - Starting MybatisplusApplication using Java 17.0.14 on thinkmacbook with PID 61324 (G:\dissertation\Bowucode\正确版本\museum_server\target\classes started by Ezekiel in G:\dissertation\Bowucode\正确版本\museum_server)
2025-09-15 20:49:27.787 [main] DEBUG com.museum.MybatisplusApplication - Running with Spring Boot v2.7.16, Spring v5.3.30
2025-09-15 20:49:27.788 [main] INFO  com.museum.MybatisplusApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-15 20:49:28.251 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-15 20:49:28.252 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-15 20:49:28.269 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Redis repository interfaces.
2025-09-15 20:49:28.681 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8090 (http)
2025-09-15 20:49:28.687 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-15 20:49:28.687 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.80]
2025-09-15 20:49:28.795 [main] INFO  o.a.c.c.ContainerBase.[Tomcat].[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-09-15 20:49:28.795 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 976 ms
2025-09-15 20:49:29.129 [main] INFO  com.museum.MybatisplusApplication - Starting MybatisplusApplication using Java 17.0.14 on thinkmacbook with PID 56512 (G:\dissertation\Bowucode\正确版本\museum_server\target\classes started by Ezekiel in G:\dissertation\Bowucode\正确版本\museum_server)
2025-09-15 20:49:29.129 [main] DEBUG com.museum.MybatisplusApplication - Running with Spring Boot v2.7.16, Spring v5.3.30
2025-09-15 20:49:29.130 [main] INFO  com.museum.MybatisplusApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-15 20:49:29.307 [main] INFO  org.redisson.Version - Redisson 3.13.6
2025-09-15 20:49:29.465 [redisson-netty-4-13] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for /127.0.0.1:6379
2025-09-15 20:49:29.474 [redisson-netty-4-13] INFO  org.redisson.connection.pool.MasterConnectionPool - 24 connections initialized for /127.0.0.1:6379
2025-09-15 20:49:29.593 [main] INFO  com.museum.config.ChromaConfig - Attempting to connect to Chroma at: http://localhost:8000/
2025-09-15 20:49:29.607 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-15 20:49:29.608 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-15 20:49:29.625 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Redis repository interfaces.
2025-09-15 20:49:29.715 [main] INFO  com.museum.config.ChromaConfig - Successfully connected to Chroma
2025-09-15 20:49:29.872 [main] INFO  com.museum.service.impl.ReserveExpirationService - 服务启动时执行预约过期检查...
2025-09-15 20:49:29.911 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-15 20:49:30.048 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8091 (http)
2025-09-15 20:49:30.053 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-15 20:49:30.053 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.80]
2025-09-15 20:49:30.098 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-15 20:49:30.101 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==>  Preparing: SELECT order_id,user_id,user_name,res_id,vld_stat,res_session,res_type,res_date,res_time FROM ms_reserve_detail WHERE (vld_stat = ? AND res_date < ?)
2025-09-15 20:49:30.118 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==> Parameters: 1(String), 2025-09-15(String)
2025-09-15 20:49:30.131 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - <==      Total: 0
2025-09-15 20:49:30.133 [main] INFO  com.museum.service.impl.ReserveExpirationService - 找到 0 条过期预约
2025-09-15 20:49:30.134 [main] INFO  com.museum.service.impl.ReserveExpirationService - 过期预约检查完成，共处理 0 条记录
2025-09-15 20:49:30.155 [main] INFO  o.a.c.c.ContainerBase.[Tomcat].[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-09-15 20:49:30.156 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 996 ms
2025-09-15 20:49:30.488 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8090 (http) with context path '/api'
2025-09-15 20:49:30.669 [main] INFO  org.redisson.Version - Redisson 3.13.6
2025-09-15 20:49:30.724 [main] INFO  com.museum.MybatisplusApplication - Started MybatisplusApplication in 3.16 seconds (JVM running for 3.55)
2025-09-15 20:49:30.732 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection info: {"id":"b880265c-e7f0-4309-9044-1630d175d540","name":"museum-collection","configuration_json":{"hnsw_configuration":{"space":"l2","ef_construction":100,"ef_search":10,"num_threads":24,"M":16,"resize_factor":1.2,"batch_size":1000,"sync_threshold":100,"_type":"HNSWConfigurationInternal"},"_type":"CollectionConfigurationInternal"},"metadata":{"hnsw:space":"cosine"},"dimension":null,"tenant":"default_tenant","database":"default_database","version":0}
2025-09-15 20:49:30.732 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Found collection ID: b880265c-e7f0-4309-9044-1630d175d540
2025-09-15 20:49:30.738 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection count response: 0
2025-09-15 20:49:30.738 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 向量数据库中已有 0 条数据
2025-09-15 20:49:30.738 [main] INFO  com.museum.service.impl.agent.DataInitializer - 开始初始化向量数据...
2025-09-15 20:49:30.738 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 开始同步所有藏品到向量数据库...
2025-09-15 20:49:30.798 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 成功删除 Chroma 集合: museum-collection
2025-09-15 20:49:30.799 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - ==>  Preparing: SELECT id,title,origin,cate_id,des_coll,col_pic,base,display_room,crt_tm,view_cnt FROM ms_collection
2025-09-15 20:49:30.800 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - ==> Parameters: 
2025-09-15 20:49:30.803 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - <==      Total: 9
2025-09-15 20:49:30.823 [redisson-netty-4-13] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for /127.0.0.1:6379
2025-09-15 20:49:30.831 [redisson-netty-4-19] INFO  org.redisson.connection.pool.MasterConnectionPool - 24 connections initialized for /127.0.0.1:6379
2025-09-15 20:49:30.934 [main] INFO  com.museum.config.ChromaConfig - Attempting to connect to Chroma at: http://localhost:8000/
2025-09-15 20:49:31.039 [main] INFO  com.museum.config.ChromaConfig - Successfully connected to Chroma
2025-09-15 20:49:31.157 [main] WARN  com.museum.service.impl.agent.VectorSyncService - 添加藏品向量失败 [殷墟·夔纹卜骨]: status code: 400; body: {"error":"InvalidCollection","message":"Collection b880265c-e7f0-4309-9044-1630d175d540 does not exist."}
2025-09-15 20:49:31.191 [main] INFO  com.museum.service.impl.ReserveExpirationService - 服务启动时执行预约过期检查...
2025-09-15 20:49:31.226 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-15 20:49:31.403 [main] WARN  com.museum.service.impl.agent.VectorSyncService - 添加藏品向量失败 [钧窑天青盏]: status code: 400; body: {"error":"InvalidCollection","message":"Collection b880265c-e7f0-4309-9044-1630d175d540 does not exist."}
2025-09-15 20:49:31.407 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-15 20:49:31.411 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==>  Preparing: SELECT order_id,user_id,user_name,res_id,vld_stat,res_session,res_type,res_date,res_time FROM ms_reserve_detail WHERE (vld_stat = ? AND res_date < ?)
2025-09-15 20:49:31.426 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==> Parameters: 1(String), 2025-09-15(String)
2025-09-15 20:49:31.436 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - <==      Total: 0
2025-09-15 20:49:31.440 [main] INFO  com.museum.service.impl.ReserveExpirationService - 找到 0 条过期预约
2025-09-15 20:49:31.441 [main] INFO  com.museum.service.impl.ReserveExpirationService - 过期预约检查完成，共处理 0 条记录
2025-09-15 20:49:31.594 [main] WARN  com.museum.service.impl.agent.VectorSyncService - 添加藏品向量失败 [璇玑陶楼]: status code: 400; body: {"error":"InvalidCollection","message":"Collection b880265c-e7f0-4309-9044-1630d175d540 does not exist."}
2025-09-15 20:49:31.744 [main] WARN  com.museum.service.impl.agent.VectorSyncService - 添加藏品向量失败 [香妃链]: status code: 400; body: {"error":"InvalidCollection","message":"Collection b880265c-e7f0-4309-9044-1630d175d540 does not exist."}
2025-09-15 20:49:31.793 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8091 (http) with context path '/api'
2025-09-15 20:49:31.961 [main] WARN  com.museum.service.impl.agent.VectorSyncService - 添加藏品向量失败 [霓裳经变图]: status code: 400; body: {"error":"InvalidCollection","message":"Collection b880265c-e7f0-4309-9044-1630d175d540 does not exist."}
2025-09-15 20:49:32.030 [main] INFO  com.museum.MybatisplusApplication - Started MybatisplusApplication in 3.119 seconds (JVM running for 3.516)
2025-09-15 20:49:32.037 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection info: {"id":"b6deb84c-eea0-40e0-9ee5-187b41d31110","name":"museum-collection","configuration_json":{"hnsw_configuration":{"space":"l2","ef_construction":100,"ef_search":10,"num_threads":24,"M":16,"resize_factor":1.2,"batch_size":1000,"sync_threshold":100,"_type":"HNSWConfigurationInternal"},"_type":"CollectionConfigurationInternal"},"metadata":{"hnsw:space":"cosine"},"dimension":null,"tenant":"default_tenant","database":"default_database","version":0}
2025-09-15 20:49:32.037 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Found collection ID: b6deb84c-eea0-40e0-9ee5-187b41d31110
2025-09-15 20:49:32.042 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection count response: 0
2025-09-15 20:49:32.042 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 向量数据库中已有 0 条数据
2025-09-15 20:49:32.042 [main] INFO  com.museum.service.impl.agent.DataInitializer - 开始初始化向量数据...
2025-09-15 20:49:32.042 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 开始同步所有藏品到向量数据库...
2025-09-15 20:49:32.090 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 成功删除 Chroma 集合: museum-collection
2025-09-15 20:49:32.091 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - ==>  Preparing: SELECT id,title,origin,cate_id,des_coll,col_pic,base,display_room,crt_tm,view_cnt FROM ms_collection
2025-09-15 20:49:32.091 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - ==> Parameters: 
2025-09-15 20:49:32.095 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - <==      Total: 9
2025-09-15 20:49:32.141 [main] WARN  com.museum.service.impl.agent.VectorSyncService - 添加藏品向量失败 [鹤影澄泥砚]: status code: 400; body: {"error":"InvalidCollection","message":"Collection b880265c-e7f0-4309-9044-1630d175d540 does not exist."}
2025-09-15 20:49:32.317 [main] WARN  com.museum.service.impl.agent.VectorSyncService - 添加藏品向量失败 [长信夔凤镜]: status code: 400; body: {"error":"InvalidCollection","message":"Collection b880265c-e7f0-4309-9044-1630d175d540 does not exist."}
2025-09-15 20:49:32.426 [main] WARN  com.museum.service.impl.agent.VectorSyncService - 添加藏品向量失败 [殷墟·夔纹卜骨]: status code: 400; body: {"error":"InvalidCollection","message":"Collection b6deb84c-eea0-40e0-9ee5-187b41d31110 does not exist."}
2025-09-15 20:49:32.496 [main] WARN  com.museum.service.impl.agent.VectorSyncService - 添加藏品向量失败 [虺龙璇玑璧]: status code: 400; body: {"error":"InvalidCollection","message":"Collection b880265c-e7f0-4309-9044-1630d175d540 does not exist."}
2025-09-15 20:49:32.619 [main] WARN  com.museum.service.impl.agent.VectorSyncService - 添加藏品向量失败 [钧窑天青盏]: status code: 400; body: {"error":"InvalidCollection","message":"Collection b6deb84c-eea0-40e0-9ee5-187b41d31110 does not exist."}
2025-09-15 20:49:32.689 [main] WARN  com.museum.service.impl.agent.VectorSyncService - 添加藏品向量失败 [玄奘九环锡杖]: status code: 400; body: {"error":"InvalidCollection","message":"Collection b880265c-e7f0-4309-9044-1630d175d540 does not exist."}
2025-09-15 20:49:32.689 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 成功同步 9 个藏品到向量数据库
2025-09-15 20:49:32.689 [main] INFO  com.museum.service.impl.agent.DataInitializer - 向量数据初始化完成
2025-09-15 20:49:32.791 [main] WARN  com.museum.service.impl.agent.VectorSyncService - 添加藏品向量失败 [璇玑陶楼]: status code: 400; body: {"error":"InvalidCollection","message":"Collection b6deb84c-eea0-40e0-9ee5-187b41d31110 does not exist."}
2025-09-15 20:49:32.943 [main] WARN  com.museum.service.impl.agent.VectorSyncService - 添加藏品向量失败 [香妃链]: status code: 400; body: {"error":"InvalidCollection","message":"Collection b6deb84c-eea0-40e0-9ee5-187b41d31110 does not exist."}
2025-09-15 20:49:33.152 [main] WARN  com.museum.service.impl.agent.VectorSyncService - 添加藏品向量失败 [霓裳经变图]: status code: 400; body: {"error":"InvalidCollection","message":"Collection b6deb84c-eea0-40e0-9ee5-187b41d31110 does not exist."}
2025-09-15 20:49:33.333 [main] WARN  com.museum.service.impl.agent.VectorSyncService - 添加藏品向量失败 [鹤影澄泥砚]: status code: 400; body: {"error":"InvalidCollection","message":"Collection b6deb84c-eea0-40e0-9ee5-187b41d31110 does not exist."}
2025-09-15 20:49:33.524 [main] WARN  com.museum.service.impl.agent.VectorSyncService - 添加藏品向量失败 [长信夔凤镜]: status code: 400; body: {"error":"InvalidCollection","message":"Collection b6deb84c-eea0-40e0-9ee5-187b41d31110 does not exist."}
2025-09-15 20:49:33.713 [main] WARN  com.museum.service.impl.agent.VectorSyncService - 添加藏品向量失败 [虺龙璇玑璧]: status code: 400; body: {"error":"InvalidCollection","message":"Collection b6deb84c-eea0-40e0-9ee5-187b41d31110 does not exist."}
2025-09-15 20:49:33.876 [main] WARN  com.museum.service.impl.agent.VectorSyncService - 添加藏品向量失败 [玄奘九环锡杖]: status code: 400; body: {"error":"InvalidCollection","message":"Collection b6deb84c-eea0-40e0-9ee5-187b41d31110 does not exist."}
2025-09-15 20:49:33.876 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 成功同步 9 个藏品到向量数据库
2025-09-15 20:49:33.876 [main] INFO  com.museum.service.impl.agent.DataInitializer - 向量数据初始化完成
2025-09-15 21:01:51.965 [http-nio-8090-exec-4] INFO  o.a.c.c.ContainerBase.[Tomcat].[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-15 21:01:51.966 [http-nio-8090-exec-4] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-15 21:01:51.966 [http-nio-8090-exec-4] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-09-15 21:01:52.057 [http-nio-8090-exec-3] DEBUG c.m.mapper.CollectionMapper.selectPage_mpCount - ==>  Preparing: SELECT COUNT(*) FROM ms_collection
2025-09-15 21:01:52.058 [http-nio-8090-exec-3] DEBUG c.m.mapper.CollectionMapper.selectPage_mpCount - ==> Parameters: 
2025-09-15 21:01:52.060 [http-nio-8090-exec-3] DEBUG c.m.mapper.CollectionMapper.selectPage_mpCount - <==      Total: 1
2025-09-15 21:01:52.064 [http-nio-8090-exec-3] DEBUG com.museum.mapper.CollectionMapper.selectPage - ==>  Preparing: SELECT id,title,origin,cate_id,des_coll,col_pic,base,display_room,crt_tm,view_cnt FROM ms_collection ORDER BY crt_tm DESC LIMIT ?
2025-09-15 21:01:52.064 [http-nio-8090-exec-3] DEBUG com.museum.mapper.CollectionMapper.selectPage - ==> Parameters: 5(Long)
2025-09-15 21:01:52.067 [http-nio-8090-exec-3] DEBUG com.museum.mapper.CollectionMapper.selectPage - <==      Total: 5
2025-09-15 21:01:53.419 [http-nio-8090-exec-2] DEBUG c.m.m.R.findReserveIdsByCateId - ==>  Preparing: SELECT reserve_id FROM ms_reserve_collection WHERE cate_id = ?
2025-09-15 21:01:53.419 [http-nio-8090-exec-2] DEBUG c.m.m.R.findReserveIdsByCateId - ==> Parameters: 9(Integer)
2025-09-15 21:01:53.422 [http-nio-8090-exec-2] DEBUG c.m.m.R.findReserveIdsByCateId - <==      Total: 0
2025-09-15 21:01:53.429 [http-nio-8090-exec-4] DEBUG com.museum.mapper.DicMapper.selectList - ==>  Preparing: SELECT id,dic_typ,dic_desc,dic_value FROM ms_dic WHERE (dic_typ = ?)
2025-09-15 21:01:53.429 [http-nio-8090-exec-4] DEBUG com.museum.mapper.DicMapper.selectList - ==> Parameters: 敏感词(String)
2025-09-15 21:01:53.429 [http-nio-8090-exec-4] DEBUG com.museum.mapper.DicMapper.selectList - <==      Total: 0
2025-09-15 21:01:53.436 [http-nio-8090-exec-4] DEBUG c.museum.mapper.FeedBackMapper.selectPage_mpCount - ==>  Preparing: SELECT COUNT(*) FROM ms_feedback WHERE (feed_content LIKE ? AND is_show = ? AND cate_id = ?)
2025-09-15 21:01:53.437 [http-nio-8090-exec-4] DEBUG c.museum.mapper.FeedBackMapper.selectPage_mpCount - ==> Parameters: %%(String), 1(Integer), 9(String)
2025-09-15 21:01:53.443 [http-nio-8090-exec-4] DEBUG c.museum.mapper.FeedBackMapper.selectPage_mpCount - <==      Total: 1
2025-09-15 21:01:53.473 [pool-3-thread-1] DEBUG com.museum.mapper.CollectionMapper.selectById - ==>  Preparing: SELECT id,title,origin,cate_id,des_coll,col_pic,base,display_room,crt_tm,view_cnt FROM ms_collection WHERE id=?
2025-09-15 21:01:53.473 [pool-3-thread-1] DEBUG com.museum.mapper.CollectionMapper.selectById - ==> Parameters: 9(Integer)
2025-09-15 21:01:53.475 [pool-2-thread-1] DEBUG com.museum.mapper.CollectionMapper.updateById - ==>  Preparing: UPDATE ms_collection SET title=?, origin=?, cate_id=?, des_coll=?, col_pic=?, base=?, display_room=?, crt_tm=?, view_cnt=? WHERE id=?
2025-09-15 21:01:53.475 [pool-2-thread-1] DEBUG com.museum.mapper.CollectionMapper.updateById - ==> Parameters: 玄奘九环锡杖(String), 唐-长安(String), 铁器(String), <p>此杖原型载于《大慈恩寺三藏法师传》，乃贞观十九年玄奘法师自天竺归唐时所携圣物。杖长五尺九寸，以于阗青玉为柄，西域精铜铸环，九枚铜环錾《金刚经》梵文，暗合"九九归真"之数。唐时供奉于大慈恩寺浮屠地宫，后随丝路佛法东传，其形制流入日本正仓院《献物帐》记载。</p><p>据《西明寺杂记》所述，此杖遇大雷雨则环上映现佛陀雪山说法影踪。唐咸通年间，有日僧圆仁于终南山见一老僧持此杖点地，枯泉复涌，遂记"锡杖触石处，隐隐现八功德水纹"。今杖身铜绿间犹存三道风沙蚀痕，考为五代时此杖流落敦煌，被用作月牙泉定沙法器之证。</p><p>北宋元祐年间，苏轼游汴京相国寺，曾见寺僧持此杖为旱灾祈雨，其在《祈雨文》中写道："锡环振而甘霖落，恍闻三十三天天鼓鸣。"明清时此杖入紫禁城佛堂，乾隆帝命造办处仿制十二柄分赐蒙藏佛寺，现存者唯拉萨哲蚌寺鎏金版可互为印证。</p><p>今人观此杖，可细辨第三环内侧粟特文刻"法流十道，声震五天"，此语竟与游戏过场动画中黑风山残碑铭文隔世相和。暮色中执杖映月，青玉纹理恰勾勒出火焰山褶皱地貌，千年风沙与数字光影在此悄然重叠。</p>(String), 20250329_01275125.png(String), 此杖原型载于《大慈恩寺三藏法师传》，乃贞观十九年玄奘法师自天竺归唐时所携圣物。杖长五尺九寸，以于阗青玉为柄，西域精铜铸环，九枚铜环錾《金刚经》梵文，暗合"九九归真"之数。(String), 展厅一(String), 2025/03/29 01:27:52(String), 30(Integer), 9(Integer)
2025-09-15 21:01:53.475 [pool-3-thread-1] DEBUG com.museum.mapper.CollectionMapper.selectById - <==      Total: 1
2025-09-15 21:01:53.476 [pool-2-thread-1] DEBUG com.museum.mapper.CollectionMapper.updateById - <==    Updates: 1
2025-09-15 21:01:53.482 [pool-2-thread-1] INFO  com.museum.service.impl.CollectionService - 异步更新id9实体点击量和缓存: 
2025-09-15 21:01:53.482 [pool-3-thread-1] INFO  com.museum.utils.CacheClient - id9 实体缓存重建成功！
2025-09-15 21:06:53.749 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-15 21:06:53.753 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-15 21:06:53.760 [pool-4-thread-1] WARN  io.lettuce.core.RedisChannelHandler - Connection is already closed
2025-09-15 21:06:53.763 [pool-4-thread-1] DEBUG com.museum.service.impl.ReserveOrderAsyncService - 处理预约订单异常
org.springframework.data.redis.RedisSystemException: Redis exception; nested exception is io.lettuce.core.RedisException: Connection closed
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:74)
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:41)
	at org.springframework.data.redis.PassThroughExceptionTranslationStrategy.translate(PassThroughExceptionTranslationStrategy.java:44)
	at org.springframework.data.redis.FallbackExceptionTranslationStrategy.translate(FallbackExceptionTranslationStrategy.java:42)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.convertLettuceAccessException(LettuceConnection.java:272)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.await(LettuceConnection.java:1063)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.lambda$doInvoke$4(LettuceConnection.java:920)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$Synchronizer.invoke(LettuceInvoker.java:673)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$DefaultManyInvocationSpec.toList(LettuceInvoker.java:618)
	at org.springframework.data.redis.connection.lettuce.LettuceStreamCommands.xReadGroup(LettuceStreamCommands.java:350)
	at org.springframework.data.redis.connection.DefaultedRedisConnection.xReadGroup(DefaultedRedisConnection.java:617)
	at org.springframework.data.redis.connection.DefaultStringRedisConnection.xReadGroup(DefaultStringRedisConnection.java:4795)
	at org.springframework.data.redis.core.DefaultStreamOperations$4.inRedis(DefaultStreamOperations.java:310)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:387)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:382)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:223)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:120)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisException: Connection closed
	at io.lettuce.core.protocol.DefaultEndpoint.notifyDrainQueuedCommands(DefaultEndpoint.java:679)
	at io.lettuce.core.protocol.CommandHandler.channelInactive(CommandHandler.java:358)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.protocol.RedisHandshakeHandler.channelInactive(RedisHandshakeHandler.java:89)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.ChannelGroupListener.channelInactive(ChannelGroupListener.java:69)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 21:06:53.766 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-15 21:06:53.770 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-15 21:06:53.772 [pool-4-thread-1] WARN  io.lettuce.core.RedisChannelHandler - Connection is already closed
2025-09-15 21:06:53.775 [pool-4-thread-1] DEBUG com.museum.service.impl.ReserveOrderAsyncService - 处理预约订单异常
org.springframework.data.redis.RedisSystemException: Redis exception; nested exception is io.lettuce.core.RedisException: Connection closed
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:74)
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:41)
	at org.springframework.data.redis.PassThroughExceptionTranslationStrategy.translate(PassThroughExceptionTranslationStrategy.java:44)
	at org.springframework.data.redis.FallbackExceptionTranslationStrategy.translate(FallbackExceptionTranslationStrategy.java:42)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.convertLettuceAccessException(LettuceConnection.java:272)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.await(LettuceConnection.java:1063)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.lambda$doInvoke$4(LettuceConnection.java:920)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$Synchronizer.invoke(LettuceInvoker.java:673)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$DefaultManyInvocationSpec.toList(LettuceInvoker.java:618)
	at org.springframework.data.redis.connection.lettuce.LettuceStreamCommands.xReadGroup(LettuceStreamCommands.java:350)
	at org.springframework.data.redis.connection.DefaultedRedisConnection.xReadGroup(DefaultedRedisConnection.java:617)
	at org.springframework.data.redis.connection.DefaultStringRedisConnection.xReadGroup(DefaultStringRedisConnection.java:4795)
	at org.springframework.data.redis.core.DefaultStreamOperations$4.inRedis(DefaultStreamOperations.java:310)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:387)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:382)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:223)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:120)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisException: Connection closed
	at io.lettuce.core.protocol.DefaultEndpoint.notifyDrainQueuedCommands(DefaultEndpoint.java:679)
	at io.lettuce.core.protocol.CommandHandler.channelInactive(CommandHandler.java:358)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.protocol.RedisHandshakeHandler.channelInactive(RedisHandshakeHandler.java:89)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.ChannelGroupListener.channelInactive(ChannelGroupListener.java:69)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 21:06:53.868 [pool-4-thread-1] ERROR com.museum.service.impl.ReserveOrderAsyncService - 处理Pending-list出现系统异常
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1689)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1597)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1383)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1366)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1093)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:421)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:193)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:144)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:105)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:210)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.handlePendingList(ReserveOrderAsyncService.java:150)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:142)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:330)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:216)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:115)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:115)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1595)
	... 18 common frames omitted
Caused by: java.lang.IllegalStateException: executor not accepting a task
	at io.netty.resolver.AddressResolverGroup.getResolver(AddressResolverGroup.java:61)
	at io.netty.bootstrap.Bootstrap.doResolveAndConnect0(Bootstrap.java:208)
	at io.netty.bootstrap.Bootstrap.access$000(Bootstrap.java:46)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:189)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:175)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:590)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:557)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:492)
	at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:636)
	at io.netty.util.concurrent.DefaultPromise.setSuccess0(DefaultPromise.java:625)
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:105)
	at io.netty.channel.DefaultChannelPromise.trySuccess(DefaultChannelPromise.java:84)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetSuccess(AbstractChannel.java:990)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.register0(AbstractChannel.java:516)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.access$200(AbstractChannel.java:429)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$1.run(AbstractChannel.java:486)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 21:06:53.884 [pool-4-thread-1] ERROR com.museum.service.impl.ReserveOrderAsyncService - 处理Pending-list出现系统异常
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1689)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1597)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1383)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1366)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1093)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:421)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:193)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:144)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:105)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:210)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.handlePendingList(ReserveOrderAsyncService.java:150)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:142)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:330)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:216)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:115)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:115)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1595)
	... 18 common frames omitted
Caused by: java.lang.IllegalStateException: executor not accepting a task
	at io.netty.resolver.AddressResolverGroup.getResolver(AddressResolverGroup.java:61)
	at io.netty.bootstrap.Bootstrap.doResolveAndConnect0(Bootstrap.java:208)
	at io.netty.bootstrap.Bootstrap.access$000(Bootstrap.java:46)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:189)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:175)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:590)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:557)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:492)
	at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:636)
	at io.netty.util.concurrent.DefaultPromise.setSuccess0(DefaultPromise.java:625)
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:105)
	at io.netty.channel.DefaultChannelPromise.trySuccess(DefaultChannelPromise.java:84)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetSuccess(AbstractChannel.java:990)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.register0(AbstractChannel.java:516)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.access$200(AbstractChannel.java:429)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$1.run(AbstractChannel.java:486)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 21:06:57.819 [main] INFO  com.museum.MybatisplusApplication - Starting MybatisplusApplication using Java 17.0.14 on thinkmacbook with PID 3032 (G:\dissertation\Bowucode\正确版本\museum_server\target\classes started by Ezekiel in G:\dissertation\Bowucode\正确版本\museum_server)
2025-09-15 21:06:57.820 [main] DEBUG com.museum.MybatisplusApplication - Running with Spring Boot v2.7.16, Spring v5.3.30
2025-09-15 21:06:57.820 [main] INFO  com.museum.MybatisplusApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-15 21:06:58.295 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-15 21:06:58.297 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-15 21:06:58.317 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Redis repository interfaces.
2025-09-15 21:06:58.738 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8090 (http)
2025-09-15 21:06:58.742 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-15 21:06:58.742 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.80]
2025-09-15 21:06:58.849 [main] INFO  o.a.c.c.ContainerBase.[Tomcat].[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-09-15 21:06:58.849 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1000 ms
2025-09-15 21:06:59.198 [main] INFO  com.museum.MybatisplusApplication - Starting MybatisplusApplication using Java 17.0.14 on thinkmacbook with PID 59252 (G:\dissertation\Bowucode\正确版本\museum_server\target\classes started by Ezekiel in G:\dissertation\Bowucode\正确版本\museum_server)
2025-09-15 21:06:59.200 [main] DEBUG com.museum.MybatisplusApplication - Running with Spring Boot v2.7.16, Spring v5.3.30
2025-09-15 21:06:59.200 [main] INFO  com.museum.MybatisplusApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-15 21:06:59.399 [main] INFO  org.redisson.Version - Redisson 3.13.6
2025-09-15 21:06:59.564 [redisson-netty-4-18] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for /127.0.0.1:6379
2025-09-15 21:06:59.574 [redisson-netty-4-19] INFO  org.redisson.connection.pool.MasterConnectionPool - 24 connections initialized for /127.0.0.1:6379
2025-09-15 21:06:59.689 [main] INFO  com.museum.config.ChromaConfig - Attempting to connect to Chroma at: http://localhost:8000/
2025-09-15 21:06:59.696 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-15 21:06:59.698 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-15 21:06:59.715 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-09-15 21:06:59.821 [main] INFO  com.museum.config.ChromaConfig - Successfully connected to Chroma
2025-09-15 21:06:59.975 [main] INFO  com.museum.service.impl.ReserveExpirationService - 服务启动时执行预约过期检查...
2025-09-15 21:07:00.025 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-15 21:07:00.141 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8091 (http)
2025-09-15 21:07:00.146 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-15 21:07:00.147 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.80]
2025-09-15 21:07:00.226 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-15 21:07:00.230 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==>  Preparing: SELECT order_id,user_id,user_name,res_id,vld_stat,res_session,res_type,res_date,res_time FROM ms_reserve_detail WHERE (vld_stat = ? AND res_date < ?)
2025-09-15 21:07:00.245 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==> Parameters: 1(String), 2025-09-15(String)
2025-09-15 21:07:00.250 [main] INFO  o.a.c.c.ContainerBase.[Tomcat].[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-09-15 21:07:00.251 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1020 ms
2025-09-15 21:07:00.257 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - <==      Total: 0
2025-09-15 21:07:00.260 [main] INFO  com.museum.service.impl.ReserveExpirationService - 找到 0 条过期预约
2025-09-15 21:07:00.260 [main] INFO  com.museum.service.impl.ReserveExpirationService - 过期预约检查完成，共处理 0 条记录
2025-09-15 21:07:00.639 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8090 (http) with context path '/api'
2025-09-15 21:07:00.794 [main] INFO  org.redisson.Version - Redisson 3.13.6
2025-09-15 21:07:00.902 [main] INFO  com.museum.MybatisplusApplication - Started MybatisplusApplication in 3.317 seconds (JVM running for 3.75)
2025-09-15 21:07:00.911 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection info: {"id":"1306a7d6-b90d-4261-887f-1d9b4e34d696","name":"museum-collection","configuration_json":{"hnsw_configuration":{"space":"l2","ef_construction":100,"ef_search":10,"num_threads":24,"M":16,"resize_factor":1.2,"batch_size":1000,"sync_threshold":100,"_type":"HNSWConfigurationInternal"},"_type":"CollectionConfigurationInternal"},"metadata":{"hnsw:space":"cosine"},"dimension":null,"tenant":"default_tenant","database":"default_database","version":0}
2025-09-15 21:07:00.911 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Found collection ID: 1306a7d6-b90d-4261-887f-1d9b4e34d696
2025-09-15 21:07:00.920 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection count response: 0
2025-09-15 21:07:00.920 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 向量数据库中已有 0 条数据
2025-09-15 21:07:00.920 [main] INFO  com.museum.service.impl.agent.DataInitializer - 开始初始化向量数据...
2025-09-15 21:07:00.920 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 开始初始化向量数据库...
2025-09-15 21:07:00.921 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - ==>  Preparing: SELECT id,title,origin,cate_id,des_coll,col_pic,base,display_room,crt_tm,view_cnt FROM ms_collection
2025-09-15 21:07:00.922 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - ==> Parameters: 
2025-09-15 21:07:00.926 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - <==      Total: 9
2025-09-15 21:07:00.949 [redisson-netty-4-14] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for /127.0.0.1:6379
2025-09-15 21:07:00.957 [redisson-netty-4-18] INFO  org.redisson.connection.pool.MasterConnectionPool - 24 connections initialized for /127.0.0.1:6379
2025-09-15 21:07:01.061 [main] INFO  com.museum.config.ChromaConfig - Attempting to connect to Chroma at: http://localhost:8000/
2025-09-15 21:07:01.119 [main] INFO  com.museum.config.ChromaConfig - Successfully connected to Chroma
2025-09-15 21:07:01.272 [main] INFO  com.museum.service.impl.ReserveExpirationService - 服务启动时执行预约过期检查...
2025-09-15 21:07:01.310 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-15 21:07:01.511 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-15 21:07:01.515 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==>  Preparing: SELECT order_id,user_id,user_name,res_id,vld_stat,res_session,res_type,res_date,res_time FROM ms_reserve_detail WHERE (vld_stat = ? AND res_date < ?)
2025-09-15 21:07:01.531 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==> Parameters: 1(String), 2025-09-15(String)
2025-09-15 21:07:01.544 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - <==      Total: 0
2025-09-15 21:07:01.547 [main] INFO  com.museum.service.impl.ReserveExpirationService - 找到 0 条过期预约
2025-09-15 21:07:01.548 [main] INFO  com.museum.service.impl.ReserveExpirationService - 过期预约检查完成，共处理 0 条记录
2025-09-15 21:07:01.596 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 殷墟·夔纹卜骨
2025-09-15 21:07:01.805 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 钧窑天青盏
2025-09-15 21:07:01.914 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8091 (http) with context path '/api'
2025-09-15 21:07:02.024 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 璇玑陶楼
2025-09-15 21:07:02.142 [main] INFO  com.museum.MybatisplusApplication - Started MybatisplusApplication in 3.178 seconds (JVM running for 3.568)
2025-09-15 21:07:02.149 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection info: {"id":"1306a7d6-b90d-4261-887f-1d9b4e34d696","name":"museum-collection","configuration_json":{"hnsw_configuration":{"space":"l2","ef_construction":100,"ef_search":10,"num_threads":24,"M":16,"resize_factor":1.2,"batch_size":1000,"sync_threshold":100,"_type":"HNSWConfigurationInternal"},"_type":"CollectionConfigurationInternal"},"metadata":{"hnsw:space":"cosine"},"dimension":1536,"tenant":"default_tenant","database":"default_database","version":0}
2025-09-15 21:07:02.149 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Found collection ID: 1306a7d6-b90d-4261-887f-1d9b4e34d696
2025-09-15 21:07:02.152 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection count response: 3
2025-09-15 21:07:02.152 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 向量数据库中已有 3 条数据
2025-09-15 21:07:02.152 [main] INFO  com.museum.service.impl.agent.DataInitializer - 向量数据已存在，跳过初始化
2025-09-15 21:07:02.199 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 香妃链
2025-09-15 21:07:02.469 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 霓裳经变图
2025-09-15 21:07:02.859 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 鹤影澄泥砚
2025-09-15 21:07:03.177 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 长信夔凤镜
2025-09-15 21:07:03.372 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 虺龙璇玑璧
2025-09-15 21:07:03.539 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 玄奘九环锡杖
2025-09-15 21:07:03.540 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 成功初始化 9 个藏品到向量数据库
2025-09-15 21:07:03.540 [main] INFO  com.museum.service.impl.agent.DataInitializer - 向量数据初始化完成
2025-09-15 21:07:27.231 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-15 21:07:27.235 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-15 21:07:27.237 [pool-4-thread-1] WARN  io.lettuce.core.RedisChannelHandler - Connection is already closed
2025-09-15 21:07:27.240 [pool-4-thread-1] DEBUG com.museum.service.impl.ReserveOrderAsyncService - 处理预约订单异常
org.springframework.data.redis.RedisSystemException: Redis exception; nested exception is io.lettuce.core.RedisException: Connection closed
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:74)
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:41)
	at org.springframework.data.redis.PassThroughExceptionTranslationStrategy.translate(PassThroughExceptionTranslationStrategy.java:44)
	at org.springframework.data.redis.FallbackExceptionTranslationStrategy.translate(FallbackExceptionTranslationStrategy.java:42)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.convertLettuceAccessException(LettuceConnection.java:272)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.await(LettuceConnection.java:1063)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.lambda$doInvoke$4(LettuceConnection.java:920)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$Synchronizer.invoke(LettuceInvoker.java:673)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$DefaultManyInvocationSpec.toList(LettuceInvoker.java:618)
	at org.springframework.data.redis.connection.lettuce.LettuceStreamCommands.xReadGroup(LettuceStreamCommands.java:350)
	at org.springframework.data.redis.connection.DefaultedRedisConnection.xReadGroup(DefaultedRedisConnection.java:617)
	at org.springframework.data.redis.connection.DefaultStringRedisConnection.xReadGroup(DefaultStringRedisConnection.java:4795)
	at org.springframework.data.redis.core.DefaultStreamOperations$4.inRedis(DefaultStreamOperations.java:310)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:387)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:382)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:223)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:120)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisException: Connection closed
	at io.lettuce.core.protocol.DefaultEndpoint.notifyDrainQueuedCommands(DefaultEndpoint.java:679)
	at io.lettuce.core.protocol.CommandHandler.channelInactive(CommandHandler.java:358)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.protocol.RedisHandshakeHandler.channelInactive(RedisHandshakeHandler.java:89)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.ChannelGroupListener.channelInactive(ChannelGroupListener.java:69)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 21:07:27.250 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-15 21:07:27.254 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-15 21:07:27.259 [pool-4-thread-1] WARN  io.lettuce.core.RedisChannelHandler - Connection is already closed
2025-09-15 21:07:27.262 [pool-4-thread-1] DEBUG com.museum.service.impl.ReserveOrderAsyncService - 处理预约订单异常
org.springframework.data.redis.RedisSystemException: Redis exception; nested exception is io.lettuce.core.RedisException: Connection closed
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:74)
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:41)
	at org.springframework.data.redis.PassThroughExceptionTranslationStrategy.translate(PassThroughExceptionTranslationStrategy.java:44)
	at org.springframework.data.redis.FallbackExceptionTranslationStrategy.translate(FallbackExceptionTranslationStrategy.java:42)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.convertLettuceAccessException(LettuceConnection.java:272)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.await(LettuceConnection.java:1063)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.lambda$doInvoke$4(LettuceConnection.java:920)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$Synchronizer.invoke(LettuceInvoker.java:673)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$DefaultManyInvocationSpec.toList(LettuceInvoker.java:618)
	at org.springframework.data.redis.connection.lettuce.LettuceStreamCommands.xReadGroup(LettuceStreamCommands.java:350)
	at org.springframework.data.redis.connection.DefaultedRedisConnection.xReadGroup(DefaultedRedisConnection.java:617)
	at org.springframework.data.redis.connection.DefaultStringRedisConnection.xReadGroup(DefaultStringRedisConnection.java:4795)
	at org.springframework.data.redis.core.DefaultStreamOperations$4.inRedis(DefaultStreamOperations.java:310)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:387)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:382)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:223)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:120)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisException: Connection closed
	at io.lettuce.core.protocol.DefaultEndpoint.notifyDrainQueuedCommands(DefaultEndpoint.java:679)
	at io.lettuce.core.protocol.CommandHandler.channelInactive(CommandHandler.java:358)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.protocol.RedisHandshakeHandler.channelInactive(RedisHandshakeHandler.java:89)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.ChannelGroupListener.channelInactive(ChannelGroupListener.java:69)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 21:07:27.340 [pool-4-thread-1] ERROR com.museum.service.impl.ReserveOrderAsyncService - 处理Pending-list出现系统异常
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1689)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1597)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1383)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1366)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1093)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:421)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:193)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:144)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:105)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:210)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.handlePendingList(ReserveOrderAsyncService.java:150)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:142)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:330)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:216)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:115)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:115)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1595)
	... 18 common frames omitted
Caused by: java.lang.IllegalStateException: executor not accepting a task
	at io.netty.resolver.AddressResolverGroup.getResolver(AddressResolverGroup.java:61)
	at io.netty.bootstrap.Bootstrap.doResolveAndConnect0(Bootstrap.java:208)
	at io.netty.bootstrap.Bootstrap.access$000(Bootstrap.java:46)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:189)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:175)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:590)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:557)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:492)
	at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:636)
	at io.netty.util.concurrent.DefaultPromise.setSuccess0(DefaultPromise.java:625)
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:105)
	at io.netty.channel.DefaultChannelPromise.trySuccess(DefaultChannelPromise.java:84)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetSuccess(AbstractChannel.java:990)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.register0(AbstractChannel.java:516)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.access$200(AbstractChannel.java:429)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$1.run(AbstractChannel.java:486)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 21:07:27.361 [pool-4-thread-1] ERROR com.museum.service.impl.ReserveOrderAsyncService - 处理Pending-list出现系统异常
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1689)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1597)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1383)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1366)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1093)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:421)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:193)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:144)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:105)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:210)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.handlePendingList(ReserveOrderAsyncService.java:150)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:142)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:330)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:216)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:115)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:115)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1595)
	... 18 common frames omitted
Caused by: java.lang.IllegalStateException: executor not accepting a task
	at io.netty.resolver.AddressResolverGroup.getResolver(AddressResolverGroup.java:61)
	at io.netty.bootstrap.Bootstrap.doResolveAndConnect0(Bootstrap.java:208)
	at io.netty.bootstrap.Bootstrap.access$000(Bootstrap.java:46)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:189)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:175)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:590)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:557)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:492)
	at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:636)
	at io.netty.util.concurrent.DefaultPromise.setSuccess0(DefaultPromise.java:625)
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:105)
	at io.netty.channel.DefaultChannelPromise.trySuccess(DefaultChannelPromise.java:84)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetSuccess(AbstractChannel.java:990)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.register0(AbstractChannel.java:516)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.access$200(AbstractChannel.java:429)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$1.run(AbstractChannel.java:486)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 21:07:29.185 [main] INFO  com.museum.MybatisplusApplication - Starting MybatisplusApplication using Java 17.0.14 on thinkmacbook with PID 63600 (G:\dissertation\Bowucode\正确版本\museum_server\target\classes started by Ezekiel in G:\dissertation\Bowucode\正确版本\museum_server)
2025-09-15 21:07:29.186 [main] DEBUG com.museum.MybatisplusApplication - Running with Spring Boot v2.7.16, Spring v5.3.30
2025-09-15 21:07:29.187 [main] INFO  com.museum.MybatisplusApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-15 21:07:29.740 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-15 21:07:29.742 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-15 21:07:29.760 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-09-15 21:07:30.232 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8091 (http)
2025-09-15 21:07:30.239 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-15 21:07:30.239 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.80]
2025-09-15 21:07:30.393 [main] INFO  o.a.c.c.ContainerBase.[Tomcat].[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-09-15 21:07:30.393 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1166 ms
2025-09-15 21:07:30.402 [main] INFO  com.museum.MybatisplusApplication - Starting MybatisplusApplication using Java 17.0.14 on thinkmacbook with PID 57188 (G:\dissertation\Bowucode\正确版本\museum_server\target\classes started by Ezekiel in G:\dissertation\Bowucode\正确版本\museum_server)
2025-09-15 21:07:30.404 [main] DEBUG com.museum.MybatisplusApplication - Running with Spring Boot v2.7.16, Spring v5.3.30
2025-09-15 21:07:30.404 [main] INFO  com.museum.MybatisplusApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-15 21:07:30.919 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-15 21:07:30.921 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-15 21:07:30.939 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-09-15 21:07:30.971 [main] INFO  org.redisson.Version - Redisson 3.13.6
2025-09-15 21:07:31.143 [redisson-netty-4-17] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for /127.0.0.1:6379
2025-09-15 21:07:31.152 [redisson-netty-4-19] INFO  org.redisson.connection.pool.MasterConnectionPool - 24 connections initialized for /127.0.0.1:6379
2025-09-15 21:07:31.261 [main] INFO  com.museum.config.ChromaConfig - Attempting to connect to Chroma at: http://localhost:8000/
2025-09-15 21:07:31.371 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8090 (http)
2025-09-15 21:07:31.376 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-15 21:07:31.377 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.80]
2025-09-15 21:07:31.389 [main] INFO  com.museum.config.ChromaConfig - Successfully connected to Chroma
2025-09-15 21:07:31.495 [main] INFO  o.a.c.c.ContainerBase.[Tomcat].[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-09-15 21:07:31.495 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1053 ms
2025-09-15 21:07:31.555 [main] INFO  com.museum.service.impl.ReserveExpirationService - 服务启动时执行预约过期检查...
2025-09-15 21:07:31.595 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-15 21:07:31.796 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-15 21:07:31.799 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==>  Preparing: SELECT order_id,user_id,user_name,res_id,vld_stat,res_session,res_type,res_date,res_time FROM ms_reserve_detail WHERE (vld_stat = ? AND res_date < ?)
2025-09-15 21:07:31.815 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==> Parameters: 1(String), 2025-09-15(String)
2025-09-15 21:07:31.827 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - <==      Total: 0
2025-09-15 21:07:31.830 [main] INFO  com.museum.service.impl.ReserveExpirationService - 找到 0 条过期预约
2025-09-15 21:07:31.830 [main] INFO  com.museum.service.impl.ReserveExpirationService - 过期预约检查完成，共处理 0 条记录
2025-09-15 21:07:32.058 [main] INFO  org.redisson.Version - Redisson 3.13.6
2025-09-15 21:07:32.219 [redisson-netty-4-14] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for /127.0.0.1:6379
2025-09-15 21:07:32.228 [redisson-netty-4-18] INFO  org.redisson.connection.pool.MasterConnectionPool - 24 connections initialized for /127.0.0.1:6379
2025-09-15 21:07:32.240 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8091 (http) with context path '/api'
2025-09-15 21:07:32.341 [main] INFO  com.museum.config.ChromaConfig - Attempting to connect to Chroma at: http://localhost:8000/
2025-09-15 21:07:32.408 [main] INFO  com.museum.config.ChromaConfig - Successfully connected to Chroma
2025-09-15 21:07:32.510 [main] INFO  com.museum.MybatisplusApplication - Started MybatisplusApplication in 3.56 seconds (JVM running for 4.004)
2025-09-15 21:07:32.516 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection info: {"id":"eeb813e9-371c-4455-beb1-66539e8914eb","name":"museum-collection","configuration_json":{"hnsw_configuration":{"space":"l2","ef_construction":100,"ef_search":10,"num_threads":24,"M":16,"resize_factor":1.2,"batch_size":1000,"sync_threshold":100,"_type":"HNSWConfigurationInternal"},"_type":"CollectionConfigurationInternal"},"metadata":{"hnsw:space":"cosine"},"dimension":null,"tenant":"default_tenant","database":"default_database","version":0}
2025-09-15 21:07:32.517 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Found collection ID: eeb813e9-371c-4455-beb1-66539e8914eb
2025-09-15 21:07:32.523 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection count response: 0
2025-09-15 21:07:32.523 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 向量数据库中已有 0 条数据
2025-09-15 21:07:32.523 [main] INFO  com.museum.service.impl.agent.DataInitializer - 开始初始化向量数据...
2025-09-15 21:07:32.523 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 开始初始化向量数据库...
2025-09-15 21:07:32.524 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - ==>  Preparing: SELECT id,title,origin,cate_id,des_coll,col_pic,base,display_room,crt_tm,view_cnt FROM ms_collection
2025-09-15 21:07:32.524 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - ==> Parameters: 
2025-09-15 21:07:32.528 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - <==      Total: 9
2025-09-15 21:07:32.553 [main] INFO  com.museum.service.impl.ReserveExpirationService - 服务启动时执行预约过期检查...
2025-09-15 21:07:32.588 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-15 21:07:32.781 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-15 21:07:32.785 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==>  Preparing: SELECT order_id,user_id,user_name,res_id,vld_stat,res_session,res_type,res_date,res_time FROM ms_reserve_detail WHERE (vld_stat = ? AND res_date < ?)
2025-09-15 21:07:32.802 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==> Parameters: 1(String), 2025-09-15(String)
2025-09-15 21:07:32.813 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - <==      Total: 0
2025-09-15 21:07:32.816 [main] INFO  com.museum.service.impl.ReserveExpirationService - 找到 0 条过期预约
2025-09-15 21:07:32.816 [main] INFO  com.museum.service.impl.ReserveExpirationService - 过期预约检查完成，共处理 0 条记录
2025-09-15 21:07:32.976 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 殷墟·夔纹卜骨
2025-09-15 21:07:33.190 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8090 (http) with context path '/api'
2025-09-15 21:07:33.224 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 钧窑天青盏
2025-09-15 21:07:33.413 [main] INFO  com.museum.MybatisplusApplication - Started MybatisplusApplication in 3.299 seconds (JVM running for 3.73)
2025-09-15 21:07:33.419 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 璇玑陶楼
2025-09-15 21:07:33.421 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection info: {"id":"eeb813e9-371c-4455-beb1-66539e8914eb","name":"museum-collection","configuration_json":{"hnsw_configuration":{"space":"l2","ef_construction":100,"ef_search":10,"num_threads":24,"M":16,"resize_factor":1.2,"batch_size":1000,"sync_threshold":100,"_type":"HNSWConfigurationInternal"},"_type":"CollectionConfigurationInternal"},"metadata":{"hnsw:space":"cosine"},"dimension":1536,"tenant":"default_tenant","database":"default_database","version":0}
2025-09-15 21:07:33.422 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Found collection ID: eeb813e9-371c-4455-beb1-66539e8914eb
2025-09-15 21:07:33.425 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection count response: 3
2025-09-15 21:07:33.425 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 向量数据库中已有 3 条数据
2025-09-15 21:07:33.425 [main] INFO  com.museum.service.impl.agent.DataInitializer - 向量数据已存在，跳过初始化
2025-09-15 21:07:33.598 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 香妃链
2025-09-15 21:07:33.804 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 霓裳经变图
2025-09-15 21:07:33.982 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 鹤影澄泥砚
2025-09-15 21:07:34.183 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 长信夔凤镜
2025-09-15 21:07:34.418 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 虺龙璇玑璧
2025-09-15 21:07:34.588 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 玄奘九环锡杖
2025-09-15 21:07:34.588 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 成功初始化 9 个藏品到向量数据库
2025-09-15 21:07:34.588 [main] INFO  com.museum.service.impl.agent.DataInitializer - 向量数据初始化完成
2025-09-15 21:15:08.537 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-15 21:15:08.542 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-15 21:15:08.545 [pool-4-thread-1] WARN  io.lettuce.core.RedisChannelHandler - Connection is already closed
2025-09-15 21:15:08.549 [pool-4-thread-1] DEBUG com.museum.service.impl.ReserveOrderAsyncService - 处理预约订单异常
org.springframework.data.redis.RedisSystemException: Redis exception; nested exception is io.lettuce.core.RedisException: Connection closed
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:74)
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:41)
	at org.springframework.data.redis.PassThroughExceptionTranslationStrategy.translate(PassThroughExceptionTranslationStrategy.java:44)
	at org.springframework.data.redis.FallbackExceptionTranslationStrategy.translate(FallbackExceptionTranslationStrategy.java:42)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.convertLettuceAccessException(LettuceConnection.java:272)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.await(LettuceConnection.java:1063)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.lambda$doInvoke$4(LettuceConnection.java:920)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$Synchronizer.invoke(LettuceInvoker.java:673)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$DefaultManyInvocationSpec.toList(LettuceInvoker.java:618)
	at org.springframework.data.redis.connection.lettuce.LettuceStreamCommands.xReadGroup(LettuceStreamCommands.java:350)
	at org.springframework.data.redis.connection.DefaultedRedisConnection.xReadGroup(DefaultedRedisConnection.java:617)
	at org.springframework.data.redis.connection.DefaultStringRedisConnection.xReadGroup(DefaultStringRedisConnection.java:4795)
	at org.springframework.data.redis.core.DefaultStreamOperations$4.inRedis(DefaultStreamOperations.java:310)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:387)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:382)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:223)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:120)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisException: Connection closed
	at io.lettuce.core.protocol.DefaultEndpoint.notifyDrainQueuedCommands(DefaultEndpoint.java:679)
	at io.lettuce.core.protocol.CommandHandler.channelInactive(CommandHandler.java:358)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.protocol.RedisHandshakeHandler.channelInactive(RedisHandshakeHandler.java:89)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.ChannelGroupListener.channelInactive(ChannelGroupListener.java:69)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 21:15:08.567 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-15 21:15:08.573 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-15 21:15:08.576 [pool-4-thread-1] WARN  io.lettuce.core.RedisChannelHandler - Connection is already closed
2025-09-15 21:15:08.578 [pool-4-thread-1] DEBUG com.museum.service.impl.ReserveOrderAsyncService - 处理预约订单异常
org.springframework.data.redis.RedisSystemException: Redis exception; nested exception is io.lettuce.core.RedisException: Connection closed
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:74)
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:41)
	at org.springframework.data.redis.PassThroughExceptionTranslationStrategy.translate(PassThroughExceptionTranslationStrategy.java:44)
	at org.springframework.data.redis.FallbackExceptionTranslationStrategy.translate(FallbackExceptionTranslationStrategy.java:42)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.convertLettuceAccessException(LettuceConnection.java:272)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.await(LettuceConnection.java:1063)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.lambda$doInvoke$4(LettuceConnection.java:920)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$Synchronizer.invoke(LettuceInvoker.java:673)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$DefaultManyInvocationSpec.toList(LettuceInvoker.java:618)
	at org.springframework.data.redis.connection.lettuce.LettuceStreamCommands.xReadGroup(LettuceStreamCommands.java:350)
	at org.springframework.data.redis.connection.DefaultedRedisConnection.xReadGroup(DefaultedRedisConnection.java:617)
	at org.springframework.data.redis.connection.DefaultStringRedisConnection.xReadGroup(DefaultStringRedisConnection.java:4795)
	at org.springframework.data.redis.core.DefaultStreamOperations$4.inRedis(DefaultStreamOperations.java:310)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:387)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:382)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:223)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:120)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisException: Connection closed
	at io.lettuce.core.protocol.DefaultEndpoint.notifyDrainQueuedCommands(DefaultEndpoint.java:679)
	at io.lettuce.core.protocol.CommandHandler.channelInactive(CommandHandler.java:358)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.protocol.RedisHandshakeHandler.channelInactive(RedisHandshakeHandler.java:89)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.ChannelGroupListener.channelInactive(ChannelGroupListener.java:69)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 21:15:08.655 [pool-4-thread-1] ERROR com.museum.service.impl.ReserveOrderAsyncService - 处理Pending-list出现系统异常
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1689)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1597)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1383)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1366)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1093)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:421)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:193)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:144)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:105)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:210)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.handlePendingList(ReserveOrderAsyncService.java:150)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:142)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:330)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:216)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:115)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:115)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1595)
	... 18 common frames omitted
Caused by: java.lang.IllegalStateException: executor not accepting a task
	at io.netty.resolver.AddressResolverGroup.getResolver(AddressResolverGroup.java:61)
	at io.netty.bootstrap.Bootstrap.doResolveAndConnect0(Bootstrap.java:208)
	at io.netty.bootstrap.Bootstrap.access$000(Bootstrap.java:46)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:189)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:175)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:590)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:557)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:492)
	at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:636)
	at io.netty.util.concurrent.DefaultPromise.setSuccess0(DefaultPromise.java:625)
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:105)
	at io.netty.channel.DefaultChannelPromise.trySuccess(DefaultChannelPromise.java:84)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetSuccess(AbstractChannel.java:990)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.register0(AbstractChannel.java:516)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.access$200(AbstractChannel.java:429)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$1.run(AbstractChannel.java:486)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 21:15:08.686 [pool-4-thread-1] ERROR com.museum.service.impl.ReserveOrderAsyncService - 处理Pending-list出现系统异常
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1689)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1597)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1383)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1366)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1093)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:421)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:193)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:144)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:105)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:210)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.handlePendingList(ReserveOrderAsyncService.java:150)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:142)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:330)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:216)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:115)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:115)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1595)
	... 18 common frames omitted
Caused by: java.lang.IllegalStateException: executor not accepting a task
	at io.netty.resolver.AddressResolverGroup.getResolver(AddressResolverGroup.java:61)
	at io.netty.bootstrap.Bootstrap.doResolveAndConnect0(Bootstrap.java:208)
	at io.netty.bootstrap.Bootstrap.access$000(Bootstrap.java:46)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:189)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:175)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:590)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:557)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:492)
	at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:636)
	at io.netty.util.concurrent.DefaultPromise.setSuccess0(DefaultPromise.java:625)
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:105)
	at io.netty.channel.DefaultChannelPromise.trySuccess(DefaultChannelPromise.java:84)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetSuccess(AbstractChannel.java:990)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.register0(AbstractChannel.java:516)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.access$200(AbstractChannel.java:429)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$1.run(AbstractChannel.java:486)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 21:15:12.327 [main] INFO  com.museum.MybatisplusApplication - Starting MybatisplusApplication using Java 17.0.14 on thinkmacbook with PID 48580 (G:\dissertation\Bowucode\正确版本\museum_server\target\classes started by Ezekiel in G:\dissertation\Bowucode\正确版本\museum_server)
2025-09-15 21:15:12.330 [main] DEBUG com.museum.MybatisplusApplication - Running with Spring Boot v2.7.16, Spring v5.3.30
2025-09-15 21:15:12.330 [main] INFO  com.museum.MybatisplusApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-15 21:15:12.814 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-15 21:15:12.815 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-15 21:15:12.832 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Redis repository interfaces.
2025-09-15 21:15:13.261 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8090 (http)
2025-09-15 21:15:13.267 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-15 21:15:13.267 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.80]
2025-09-15 21:15:13.376 [main] INFO  o.a.c.c.ContainerBase.[Tomcat].[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-09-15 21:15:13.376 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1013 ms
2025-09-15 21:15:13.636 [main] INFO  com.museum.MybatisplusApplication - Starting MybatisplusApplication using Java 17.0.14 on thinkmacbook with PID 60712 (G:\dissertation\Bowucode\正确版本\museum_server\target\classes started by Ezekiel in G:\dissertation\Bowucode\正确版本\museum_server)
2025-09-15 21:15:13.638 [main] DEBUG com.museum.MybatisplusApplication - Running with Spring Boot v2.7.16, Spring v5.3.30
2025-09-15 21:15:13.638 [main] INFO  com.museum.MybatisplusApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-15 21:15:13.897 [main] INFO  org.redisson.Version - Redisson 3.13.6
2025-09-15 21:15:14.055 [redisson-netty-4-15] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for /127.0.0.1:6379
2025-09-15 21:15:14.068 [redisson-netty-4-15] INFO  org.redisson.connection.pool.MasterConnectionPool - 24 connections initialized for /127.0.0.1:6379
2025-09-15 21:15:14.109 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-15 21:15:14.111 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-15 21:15:14.130 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-09-15 21:15:14.182 [main] INFO  com.museum.config.ChromaConfig - Attempting to connect to Chroma at: http://localhost:8000/
2025-09-15 21:15:14.309 [main] INFO  com.museum.config.ChromaConfig - Successfully connected to Chroma
2025-09-15 21:15:14.455 [main] INFO  com.museum.service.impl.ReserveExpirationService - 服务启动时执行预约过期检查...
2025-09-15 21:15:14.499 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-15 21:15:14.558 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8091 (http)
2025-09-15 21:15:14.563 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-15 21:15:14.563 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.80]
2025-09-15 21:15:14.666 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-15 21:15:14.667 [main] INFO  o.a.c.c.ContainerBase.[Tomcat].[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-09-15 21:15:14.667 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 999 ms
2025-09-15 21:15:14.669 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==>  Preparing: SELECT order_id,user_id,user_name,res_id,vld_stat,res_session,res_type,res_date,res_time FROM ms_reserve_detail WHERE (vld_stat = ? AND res_date < ?)
2025-09-15 21:15:14.684 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==> Parameters: 1(String), 2025-09-15(String)
2025-09-15 21:15:14.698 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - <==      Total: 0
2025-09-15 21:15:14.700 [main] INFO  com.museum.service.impl.ReserveExpirationService - 找到 0 条过期预约
2025-09-15 21:15:14.700 [main] INFO  com.museum.service.impl.ReserveExpirationService - 过期预约检查完成，共处理 0 条记录
2025-09-15 21:15:15.069 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8090 (http) with context path '/api'
2025-09-15 21:15:15.190 [main] INFO  org.redisson.Version - Redisson 3.13.6
2025-09-15 21:15:15.324 [main] INFO  com.museum.MybatisplusApplication - Started MybatisplusApplication in 3.206 seconds (JVM running for 3.591)
2025-09-15 21:15:15.332 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection info: {"id":"0d4779b0-227e-49cb-8c79-a45a989b9401","name":"museum-collection","configuration_json":{"hnsw_configuration":{"space":"l2","ef_construction":100,"ef_search":10,"num_threads":24,"M":16,"resize_factor":1.2,"batch_size":1000,"sync_threshold":100,"_type":"HNSWConfigurationInternal"},"_type":"CollectionConfigurationInternal"},"metadata":{"hnsw:space":"cosine"},"dimension":null,"tenant":"default_tenant","database":"default_database","version":0}
2025-09-15 21:15:15.334 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Found collection ID: 0d4779b0-227e-49cb-8c79-a45a989b9401
2025-09-15 21:15:15.342 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection count response: 0
2025-09-15 21:15:15.342 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 向量数据库中已有 0 条数据
2025-09-15 21:15:15.342 [main] INFO  com.museum.service.impl.agent.DataInitializer - 开始初始化向量数据...
2025-09-15 21:15:15.342 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 开始初始化向量数据库...
2025-09-15 21:15:15.343 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - ==>  Preparing: SELECT id,title,origin,cate_id,des_coll,col_pic,base,display_room,crt_tm,view_cnt FROM ms_collection
2025-09-15 21:15:15.344 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - ==> Parameters: 
2025-09-15 21:15:15.347 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - <==      Total: 9
2025-09-15 21:15:15.360 [redisson-netty-4-23] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for /127.0.0.1:6379
2025-09-15 21:15:15.367 [redisson-netty-4-18] INFO  org.redisson.connection.pool.MasterConnectionPool - 24 connections initialized for /127.0.0.1:6379
2025-09-15 21:15:15.478 [main] INFO  com.museum.config.ChromaConfig - Attempting to connect to Chroma at: http://localhost:8000/
2025-09-15 21:15:15.532 [main] INFO  com.museum.config.ChromaConfig - Successfully connected to Chroma
2025-09-15 21:15:15.680 [main] INFO  com.museum.service.impl.ReserveExpirationService - 服务启动时执行预约过期检查...
2025-09-15 21:15:15.718 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-15 21:15:15.760 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 殷墟·夔纹卜骨
2025-09-15 21:15:15.890 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-15 21:15:15.893 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==>  Preparing: SELECT order_id,user_id,user_name,res_id,vld_stat,res_session,res_type,res_date,res_time FROM ms_reserve_detail WHERE (vld_stat = ? AND res_date < ?)
2025-09-15 21:15:15.909 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==> Parameters: 1(String), 2025-09-15(String)
2025-09-15 21:15:15.920 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - <==      Total: 0
2025-09-15 21:15:15.923 [main] INFO  com.museum.service.impl.ReserveExpirationService - 找到 0 条过期预约
2025-09-15 21:15:15.923 [main] INFO  com.museum.service.impl.ReserveExpirationService - 过期预约检查完成，共处理 0 条记录
2025-09-15 21:15:15.971 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 钧窑天青盏
2025-09-15 21:15:16.183 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 璇玑陶楼
2025-09-15 21:15:16.284 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8091 (http) with context path '/api'
2025-09-15 21:15:16.392 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 香妃链
2025-09-15 21:15:16.530 [main] INFO  com.museum.MybatisplusApplication - Started MybatisplusApplication in 3.108 seconds (JVM running for 3.506)
2025-09-15 21:15:16.537 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection info: {"id":"0d4779b0-227e-49cb-8c79-a45a989b9401","name":"museum-collection","configuration_json":{"hnsw_configuration":{"space":"l2","ef_construction":100,"ef_search":10,"num_threads":24,"M":16,"resize_factor":1.2,"batch_size":1000,"sync_threshold":100,"_type":"HNSWConfigurationInternal"},"_type":"CollectionConfigurationInternal"},"metadata":{"hnsw:space":"cosine"},"dimension":1536,"tenant":"default_tenant","database":"default_database","version":0}
2025-09-15 21:15:16.537 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Found collection ID: 0d4779b0-227e-49cb-8c79-a45a989b9401
2025-09-15 21:15:16.540 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection count response: 4
2025-09-15 21:15:16.540 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 向量数据库中已有 4 条数据
2025-09-15 21:15:16.540 [main] INFO  com.museum.service.impl.agent.DataInitializer - 向量数据已存在，跳过初始化
2025-09-15 21:15:16.624 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 霓裳经变图
2025-09-15 21:15:16.849 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 鹤影澄泥砚
2025-09-15 21:15:17.149 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 长信夔凤镜
2025-09-15 21:15:17.345 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 虺龙璇玑璧
2025-09-15 21:15:17.547 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 玄奘九环锡杖
2025-09-15 21:15:17.549 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 成功初始化 9 个藏品到向量数据库
2025-09-15 21:15:17.549 [main] INFO  com.museum.service.impl.agent.DataInitializer - 向量数据初始化完成
2025-09-15 21:19:04.702 [http-nio-8090-exec-2] INFO  o.a.c.c.ContainerBase.[Tomcat].[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-15 21:19:04.702 [http-nio-8090-exec-2] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-15 21:19:04.703 [http-nio-8090-exec-2] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-09-15 21:19:24.597 [http-nio-8090-exec-2] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==>  Preparing: SELECT order_id,user_id,user_name,res_id,vld_stat,res_session,res_type,res_date,res_time FROM ms_reserve_detail WHERE (user_id = ? AND vld_stat = ?)
2025-09-15 21:19:24.597 [http-nio-8090-exec-2] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==> Parameters: test-session-001(String), 1(String)
2025-09-15 21:19:24.599 [http-nio-8090-exec-2] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - <==      Total: 0
2025-09-15 21:33:27.071 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-15 21:33:27.075 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-15 21:33:27.077 [pool-4-thread-1] WARN  io.lettuce.core.RedisChannelHandler - Connection is already closed
2025-09-15 21:33:27.079 [pool-4-thread-1] DEBUG com.museum.service.impl.ReserveOrderAsyncService - 处理预约订单异常
org.springframework.data.redis.RedisSystemException: Redis exception; nested exception is io.lettuce.core.RedisException: Connection closed
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:74)
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:41)
	at org.springframework.data.redis.PassThroughExceptionTranslationStrategy.translate(PassThroughExceptionTranslationStrategy.java:44)
	at org.springframework.data.redis.FallbackExceptionTranslationStrategy.translate(FallbackExceptionTranslationStrategy.java:42)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.convertLettuceAccessException(LettuceConnection.java:272)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.await(LettuceConnection.java:1063)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.lambda$doInvoke$4(LettuceConnection.java:920)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$Synchronizer.invoke(LettuceInvoker.java:673)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$DefaultManyInvocationSpec.toList(LettuceInvoker.java:618)
	at org.springframework.data.redis.connection.lettuce.LettuceStreamCommands.xReadGroup(LettuceStreamCommands.java:350)
	at org.springframework.data.redis.connection.DefaultedRedisConnection.xReadGroup(DefaultedRedisConnection.java:617)
	at org.springframework.data.redis.connection.DefaultStringRedisConnection.xReadGroup(DefaultStringRedisConnection.java:4795)
	at org.springframework.data.redis.core.DefaultStreamOperations$4.inRedis(DefaultStreamOperations.java:310)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:387)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:382)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:223)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:120)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisException: Connection closed
	at io.lettuce.core.protocol.DefaultEndpoint.notifyDrainQueuedCommands(DefaultEndpoint.java:679)
	at io.lettuce.core.protocol.CommandHandler.channelInactive(CommandHandler.java:358)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.protocol.RedisHandshakeHandler.channelInactive(RedisHandshakeHandler.java:89)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.ChannelGroupListener.channelInactive(ChannelGroupListener.java:69)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 21:33:27.093 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-15 21:33:27.098 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-15 21:33:27.100 [pool-4-thread-1] WARN  io.lettuce.core.RedisChannelHandler - Connection is already closed
2025-09-15 21:33:27.102 [pool-4-thread-1] DEBUG com.museum.service.impl.ReserveOrderAsyncService - 处理预约订单异常
org.springframework.data.redis.RedisSystemException: Redis exception; nested exception is io.lettuce.core.RedisException: Connection closed
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:74)
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:41)
	at org.springframework.data.redis.PassThroughExceptionTranslationStrategy.translate(PassThroughExceptionTranslationStrategy.java:44)
	at org.springframework.data.redis.FallbackExceptionTranslationStrategy.translate(FallbackExceptionTranslationStrategy.java:42)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.convertLettuceAccessException(LettuceConnection.java:272)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.await(LettuceConnection.java:1063)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.lambda$doInvoke$4(LettuceConnection.java:920)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$Synchronizer.invoke(LettuceInvoker.java:673)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$DefaultManyInvocationSpec.toList(LettuceInvoker.java:618)
	at org.springframework.data.redis.connection.lettuce.LettuceStreamCommands.xReadGroup(LettuceStreamCommands.java:350)
	at org.springframework.data.redis.connection.DefaultedRedisConnection.xReadGroup(DefaultedRedisConnection.java:617)
	at org.springframework.data.redis.connection.DefaultStringRedisConnection.xReadGroup(DefaultStringRedisConnection.java:4795)
	at org.springframework.data.redis.core.DefaultStreamOperations$4.inRedis(DefaultStreamOperations.java:310)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:387)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:382)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:223)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:120)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisException: Connection closed
	at io.lettuce.core.protocol.DefaultEndpoint.notifyDrainQueuedCommands(DefaultEndpoint.java:679)
	at io.lettuce.core.protocol.CommandHandler.channelInactive(CommandHandler.java:358)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.protocol.RedisHandshakeHandler.channelInactive(RedisHandshakeHandler.java:89)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.ChannelGroupListener.channelInactive(ChannelGroupListener.java:69)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 21:33:27.187 [pool-4-thread-1] ERROR com.museum.service.impl.ReserveOrderAsyncService - 处理Pending-list出现系统异常
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1689)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1597)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1383)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1366)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1093)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:421)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:193)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:144)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:105)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:210)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.handlePendingList(ReserveOrderAsyncService.java:150)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:142)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:330)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:216)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:115)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:115)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1595)
	... 18 common frames omitted
Caused by: java.lang.IllegalStateException: executor not accepting a task
	at io.netty.resolver.AddressResolverGroup.getResolver(AddressResolverGroup.java:61)
	at io.netty.bootstrap.Bootstrap.doResolveAndConnect0(Bootstrap.java:208)
	at io.netty.bootstrap.Bootstrap.access$000(Bootstrap.java:46)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:189)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:175)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:590)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:557)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:492)
	at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:636)
	at io.netty.util.concurrent.DefaultPromise.setSuccess0(DefaultPromise.java:625)
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:105)
	at io.netty.channel.DefaultChannelPromise.trySuccess(DefaultChannelPromise.java:84)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetSuccess(AbstractChannel.java:990)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.register0(AbstractChannel.java:516)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.access$200(AbstractChannel.java:429)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$1.run(AbstractChannel.java:486)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 21:33:27.216 [pool-4-thread-1] ERROR com.museum.service.impl.ReserveOrderAsyncService - 处理Pending-list出现系统异常
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1689)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1597)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1383)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1366)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1093)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:421)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:193)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:144)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:105)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:210)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.handlePendingList(ReserveOrderAsyncService.java:150)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:142)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:330)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:216)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:115)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:115)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1595)
	... 18 common frames omitted
Caused by: java.lang.IllegalStateException: executor not accepting a task
	at io.netty.resolver.AddressResolverGroup.getResolver(AddressResolverGroup.java:61)
	at io.netty.bootstrap.Bootstrap.doResolveAndConnect0(Bootstrap.java:208)
	at io.netty.bootstrap.Bootstrap.access$000(Bootstrap.java:46)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:189)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:175)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:590)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:557)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:492)
	at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:636)
	at io.netty.util.concurrent.DefaultPromise.setSuccess0(DefaultPromise.java:625)
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:105)
	at io.netty.channel.DefaultChannelPromise.trySuccess(DefaultChannelPromise.java:84)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetSuccess(AbstractChannel.java:990)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.register0(AbstractChannel.java:516)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.access$200(AbstractChannel.java:429)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$1.run(AbstractChannel.java:486)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 21:33:49.773 [main] INFO  com.museum.MybatisplusApplication - Starting MybatisplusApplication using Java 17.0.14 on thinkmacbook with PID 59192 (G:\dissertation\Bowucode\正确版本\museum_server\target\classes started by Ezekiel in G:\dissertation\Bowucode\正确版本\museum_server)
2025-09-15 21:33:49.774 [main] DEBUG com.museum.MybatisplusApplication - Running with Spring Boot v2.7.16, Spring v5.3.30
2025-09-15 21:33:49.775 [main] INFO  com.museum.MybatisplusApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-15 21:33:50.252 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-15 21:33:50.253 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-15 21:33:50.270 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-09-15 21:33:50.685 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8090 (http)
2025-09-15 21:33:50.691 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-15 21:33:50.692 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.80]
2025-09-15 21:33:50.804 [main] INFO  o.a.c.c.ContainerBase.[Tomcat].[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-09-15 21:33:50.804 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 998 ms
2025-09-15 21:33:51.206 [main] INFO  com.museum.MybatisplusApplication - Starting MybatisplusApplication using Java 17.0.14 on thinkmacbook with PID 59708 (G:\dissertation\Bowucode\正确版本\museum_server\target\classes started by Ezekiel in G:\dissertation\Bowucode\正确版本\museum_server)
2025-09-15 21:33:51.207 [main] DEBUG com.museum.MybatisplusApplication - Running with Spring Boot v2.7.16, Spring v5.3.30
2025-09-15 21:33:51.209 [main] INFO  com.museum.MybatisplusApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-15 21:33:51.323 [main] INFO  org.redisson.Version - Redisson 3.13.6
2025-09-15 21:33:51.480 [redisson-netty-4-23] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for /127.0.0.1:6379
2025-09-15 21:33:51.488 [redisson-netty-4-19] INFO  org.redisson.connection.pool.MasterConnectionPool - 24 connections initialized for /127.0.0.1:6379
2025-09-15 21:33:51.596 [main] INFO  com.museum.config.ChromaConfig - Attempting to connect to Chroma at: http://localhost:8000/
2025-09-15 21:33:51.663 [main] INFO  com.museum.config.ChromaConfig - Successfully connected to Chroma
2025-09-15 21:33:51.687 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-15 21:33:51.688 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-15 21:33:51.705 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-09-15 21:33:51.806 [main] INFO  com.museum.service.impl.agent.IntentRouterImpl - 意图路由器初始化完成 - 已注册工具: [RULES, CULTURE, RECOMMEND]
2025-09-15 21:33:51.817 [main] INFO  com.museum.service.impl.ReserveExpirationService - 服务启动时执行预约过期检查...
2025-09-15 21:33:51.855 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-15 21:33:52.023 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-15 21:33:52.028 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==>  Preparing: SELECT order_id,user_id,user_name,res_id,vld_stat,res_session,res_type,res_date,res_time FROM ms_reserve_detail WHERE (vld_stat = ? AND res_date < ?)
2025-09-15 21:33:52.044 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==> Parameters: 1(String), 2025-09-15(String)
2025-09-15 21:33:52.056 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - <==      Total: 0
2025-09-15 21:33:52.059 [main] INFO  com.museum.service.impl.ReserveExpirationService - 找到 0 条过期预约
2025-09-15 21:33:52.059 [main] INFO  com.museum.service.impl.ReserveExpirationService - 过期预约检查完成，共处理 0 条记录
2025-09-15 21:33:52.122 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8091 (http)
2025-09-15 21:33:52.127 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-15 21:33:52.127 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.80]
2025-09-15 21:33:52.253 [main] INFO  o.a.c.c.ContainerBase.[Tomcat].[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-09-15 21:33:52.254 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1005 ms
2025-09-15 21:33:52.429 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8090 (http) with context path '/api'
2025-09-15 21:33:52.668 [main] INFO  com.museum.MybatisplusApplication - Started MybatisplusApplication in 3.108 seconds (JVM running for 3.512)
2025-09-15 21:33:52.675 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection info: {"id":"0d4779b0-227e-49cb-8c79-a45a989b9401","name":"museum-collection","configuration_json":{"hnsw_configuration":{"space":"l2","ef_construction":100,"ef_search":10,"num_threads":24,"M":16,"resize_factor":1.2,"batch_size":1000,"sync_threshold":100,"_type":"HNSWConfigurationInternal"},"_type":"CollectionConfigurationInternal"},"metadata":{"hnsw:space":"cosine"},"dimension":1536,"tenant":"default_tenant","database":"default_database","version":0}
2025-09-15 21:33:52.675 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Found collection ID: 0d4779b0-227e-49cb-8c79-a45a989b9401
2025-09-15 21:33:52.678 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection count response: 9
2025-09-15 21:33:52.679 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 向量数据库中已有 9 条数据
2025-09-15 21:33:52.679 [main] INFO  com.museum.service.impl.agent.DataInitializer - 向量数据已存在，跳过初始化
2025-09-15 21:33:52.769 [main] INFO  org.redisson.Version - Redisson 3.13.6
2025-09-15 21:33:52.936 [redisson-netty-4-13] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for /127.0.0.1:6379
2025-09-15 21:33:52.945 [redisson-netty-4-19] INFO  org.redisson.connection.pool.MasterConnectionPool - 24 connections initialized for /127.0.0.1:6379
2025-09-15 21:33:53.070 [main] INFO  com.museum.config.ChromaConfig - Attempting to connect to Chroma at: http://localhost:8000/
2025-09-15 21:33:53.131 [main] INFO  com.museum.config.ChromaConfig - Successfully connected to Chroma
2025-09-15 21:33:53.263 [main] INFO  com.museum.service.impl.agent.IntentRouterImpl - 意图路由器初始化完成 - 已注册工具: [RULES, CULTURE, RECOMMEND]
2025-09-15 21:33:53.273 [main] INFO  com.museum.service.impl.ReserveExpirationService - 服务启动时执行预约过期检查...
2025-09-15 21:33:53.312 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-15 21:33:53.472 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-15 21:33:53.475 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==>  Preparing: SELECT order_id,user_id,user_name,res_id,vld_stat,res_session,res_type,res_date,res_time FROM ms_reserve_detail WHERE (vld_stat = ? AND res_date < ?)
2025-09-15 21:33:53.491 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==> Parameters: 1(String), 2025-09-15(String)
2025-09-15 21:33:53.503 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - <==      Total: 0
2025-09-15 21:33:53.506 [main] INFO  com.museum.service.impl.ReserveExpirationService - 找到 0 条过期预约
2025-09-15 21:33:53.506 [main] INFO  com.museum.service.impl.ReserveExpirationService - 过期预约检查完成，共处理 0 条记录
2025-09-15 21:33:53.860 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8091 (http) with context path '/api'
2025-09-15 21:33:54.081 [main] INFO  com.museum.MybatisplusApplication - Started MybatisplusApplication in 3.097 seconds (JVM running for 3.497)
2025-09-15 21:33:54.087 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection info: {"id":"0d4779b0-227e-49cb-8c79-a45a989b9401","name":"museum-collection","configuration_json":{"hnsw_configuration":{"space":"l2","ef_construction":100,"ef_search":10,"num_threads":24,"M":16,"resize_factor":1.2,"batch_size":1000,"sync_threshold":100,"_type":"HNSWConfigurationInternal"},"_type":"CollectionConfigurationInternal"},"metadata":{"hnsw:space":"cosine"},"dimension":1536,"tenant":"default_tenant","database":"default_database","version":0}
2025-09-15 21:33:54.088 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Found collection ID: 0d4779b0-227e-49cb-8c79-a45a989b9401
2025-09-15 21:33:54.091 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection count response: 9
2025-09-15 21:33:54.091 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 向量数据库中已有 9 条数据
2025-09-15 21:33:54.091 [main] INFO  com.museum.service.impl.agent.DataInitializer - 向量数据已存在，跳过初始化
2025-09-15 21:34:18.780 [http-nio-8090-exec-2] INFO  o.a.c.c.ContainerBase.[Tomcat].[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-15 21:34:18.780 [http-nio-8090-exec-2] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-15 21:34:18.781 [http-nio-8090-exec-2] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-09-15 21:34:18.799 [http-nio-8090-exec-2] INFO  com.museum.service.impl.agent.GuideAgentService - 开始处理用户消息 - 会话ID: test-session-001, 消息: '博物馆的开放时间是什么时候？'
2025-09-15 21:34:18.799 [http-nio-8090-exec-2] DEBUG c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类 - 用户输入: 博物馆的开放时间是什么时候？
2025-09-15 21:34:18.799 [http-nio-8090-exec-2] DEBUG c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类 - 发送给LLM的prompt: 请判断以下用户输入的意图类型，严格按照以下规则分类：

## 分类规则：

**RULES** - 规章制度和基本信息查询：
- 博物馆开放时间、闭馆时间
- 门票价格、购票方式
- 参观规则、注意事项
- 地址、交通、停车
- 联系方式、客服
- 拍照规定、禁止事项
- 导览服务、讲解时间

**CULTURE** - 文化背景和藏品知识：
- 藏品历史、文化背景
- 文物介绍、制作工艺
- 朝代历史、文化故事
- 艺术价值、收藏意义
- 考古发现、文物保护
- 传统文化、民俗风情

**RECOMMEND** - 推荐和建议：
- 推荐展览、展品
- 参观路线建议
- 必看藏品推荐
- 适合特定人群的展览
- 个性化推荐

## 用户输入：
博物馆的开放时间是什么时候？
## 要求：
请仅返回以下三个选项之一，不要包含其他内容：
RULES
CULTURE
RECOMMEND

2025-09-15 21:34:19.268 [http-nio-8090-exec-2] DEBUG c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类 - LLM原始回复: RULES
2025-09-15 21:34:19.268 [http-nio-8090-exec-2] DEBUG c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类 - 标准化后: RULES
2025-09-15 21:34:19.268 [http-nio-8090-exec-2] INFO  c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类结果 - 用户输入: '博物馆的开放时间是什么时候？' -> 意图: RULES
2025-09-15 21:34:19.268 [http-nio-8090-exec-2] INFO  com.museum.service.impl.agent.GuideAgentService - 意图分类完成 - 会话ID: test-session-001, 分类结果: RULES
2025-09-15 21:34:19.268 [http-nio-8090-exec-2] DEBUG com.museum.service.impl.agent.GuideAgentService - 开始路由到对应工具 - 意图: RULES
2025-09-15 21:34:19.269 [http-nio-8090-exec-2] INFO  com.museum.service.impl.agent.IntentRouterImpl - 路由决策 - 意图: RULES -> 工具: RulesQATool
2025-09-15 21:34:19.269 [http-nio-8090-exec-2] DEBUG com.museum.service.impl.agent.IntentRouterImpl - 执行工具 - 工具: RulesQATool, 用户输入: '博物馆的开放时间是什么时候？', 会话ID: test-session-001
2025-09-15 21:34:22.527 [http-nio-8090-exec-2] INFO  com.museum.service.impl.agent.IntentRouterImpl - 工具执行完成 - 工具: RulesQATool, 响应长度: 159 字符
2025-09-15 21:34:22.528 [http-nio-8090-exec-2] INFO  com.museum.service.impl.agent.GuideAgentService - 消息处理完成 - 会话ID: test-session-001, 响应长度: 159 字符
2025-09-15 21:34:22.528 [http-nio-8090-exec-2] DEBUG com.museum.service.impl.agent.GuideAgentService - 完整响应内容: 您好，关于博物馆的开放时间，不同博物馆会根据自身情况设定不同的开放时段。一般来说，大多数博物馆的开放时间为每周二至周日9:00-17:00（16:30停止入场），周一闭馆（法定节假日除外）。

建议您关注具体博物馆的官方公告或文旅平台发布的相关信息，以获取准确的开放时间安排。

信息来源：文旅平台博物馆展览服务指南。
2025-09-15 21:36:08.873 [http-nio-8090-exec-5] INFO  com.museum.service.impl.agent.GuideAgentService - 开始处理用户消息 - 会话ID: test-session-001, 消息: '我很喜欢大清的藏品，很有韵味，馆内有清代藏品吗？'
2025-09-15 21:36:08.874 [http-nio-8090-exec-5] DEBUG c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类 - 用户输入: 我很喜欢大清的藏品，很有韵味，馆内有清代藏品吗？
2025-09-15 21:36:08.874 [http-nio-8090-exec-5] DEBUG c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类 - 发送给LLM的prompt: 请判断以下用户输入的意图类型，严格按照以下规则分类：

## 分类规则：

**RULES** - 规章制度和基本信息查询：
- 博物馆开放时间、闭馆时间
- 门票价格、购票方式
- 参观规则、注意事项
- 地址、交通、停车
- 联系方式、客服
- 拍照规定、禁止事项
- 导览服务、讲解时间

**CULTURE** - 文化背景和藏品知识：
- 藏品历史、文化背景
- 文物介绍、制作工艺
- 朝代历史、文化故事
- 艺术价值、收藏意义
- 考古发现、文物保护
- 传统文化、民俗风情

**RECOMMEND** - 推荐和建议：
- 推荐展览、展品
- 参观路线建议
- 必看藏品推荐
- 适合特定人群的展览
- 个性化推荐

## 用户输入：
我很喜欢大清的藏品，很有韵味，馆内有清代藏品吗？
## 要求：
请仅返回以下三个选项之一，不要包含其他内容：
RULES
CULTURE
RECOMMEND

2025-09-15 21:36:09.480 [http-nio-8090-exec-5] DEBUG c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类 - LLM原始回复: CULTURE
2025-09-15 21:36:09.481 [http-nio-8090-exec-5] DEBUG c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类 - 标准化后: CULTURE
2025-09-15 21:36:09.481 [http-nio-8090-exec-5] INFO  c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类结果 - 用户输入: '我很喜欢大清的藏品，很有韵味，馆内有清代藏品吗？' -> 意图: CULTURE
2025-09-15 21:36:09.481 [http-nio-8090-exec-5] INFO  com.museum.service.impl.agent.GuideAgentService - 意图分类完成 - 会话ID: test-session-001, 分类结果: CULTURE
2025-09-15 21:36:09.481 [http-nio-8090-exec-5] DEBUG com.museum.service.impl.agent.GuideAgentService - 开始路由到对应工具 - 意图: CULTURE
2025-09-15 21:36:09.481 [http-nio-8090-exec-5] INFO  com.museum.service.impl.agent.IntentRouterImpl - 路由决策 - 意图: CULTURE -> 工具: CultureRAGTool
2025-09-15 21:36:09.481 [http-nio-8090-exec-5] DEBUG com.museum.service.impl.agent.IntentRouterImpl - 执行工具 - 工具: CultureRAGTool, 用户输入: '我很喜欢大清的藏品，很有韵味，馆内有清代藏品吗？', 会话ID: test-session-001
2025-09-15 21:36:09.687 [http-nio-8090-exec-5] INFO  com.museum.service.impl.agent.CultureRAGTool - RAG查询 - 会话ID: test-session-001, 用户输入: 我很喜欢大清的藏品，很有韵味，馆内有清代藏品吗？, 检索文档数: 5, 相关性分数: 0.647
2025-09-15 21:36:16.411 [http-nio-8090-exec-5] INFO  com.museum.service.impl.agent.IntentRouterImpl - 工具执行完成 - 工具: CultureRAGTool, 响应长度: 424 字符
2025-09-15 21:36:16.411 [http-nio-8090-exec-5] INFO  com.museum.service.impl.agent.GuideAgentService - 消息处理完成 - 会话ID: test-session-001, 响应长度: 424 字符
2025-09-15 21:36:16.411 [http-nio-8090-exec-5] DEBUG com.museum.service.impl.agent.GuideAgentService - 完整响应内容: 馆内确实有清代的藏品，其中一件非常具有代表性的清代文物就是**香妃链**。

### 香妃链

- **来源**：清朝乾隆年间，由宫廷工匠精心打造，专为香妃伊帕尔罕所制。
- **材质**：由珍贵的宝石和珍珠串成，每一颗宝石都经过精心挑选，以确保色泽和光泽能够衬托出香妃的美貌。
- **文化特色**：项链的设计融合了满族和维吾尔族的艺术元素，体现了清朝时期多民族融合的文化背景。
- **历史与传说**：香妃链不仅是一件精美的饰品，更是一件有生命的古董。它见证了香妃的悲欢离合，承载着她对爱情的渴望和对未来的憧憬。传说佩戴香妃链可以感受到与香妃灵魂的微妙联系，甚至能够实现佩戴者心中最深切的愿望。
- **展示位置**：此藏品陈列在**展厅四**。

除了香妃链，虽然其他藏品的时间跨度涵盖了汉代、唐代、战国等时期，但香妃链作为清代的代表文物，充分展现了清代宫廷工艺的精致与文化的深厚底蕴。如果您对清代文化感兴趣，香妃链无疑是一个不容错过的展品。
2025-09-15 21:38:32.969 [http-nio-8090-exec-9] INFO  com.museum.service.impl.agent.GuideAgentService - 开始处理用户消息 - 会话ID: test-session-001, 消息: '唐代的藏品呢？它们有什么故事'
2025-09-15 21:38:32.969 [http-nio-8090-exec-9] DEBUG c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类 - 用户输入: 唐代的藏品呢？它们有什么故事
2025-09-15 21:38:32.969 [http-nio-8090-exec-9] DEBUG c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类 - 发送给LLM的prompt: 请判断以下用户输入的意图类型，严格按照以下规则分类：

## 分类规则：

**RULES** - 规章制度和基本信息查询：
- 博物馆开放时间、闭馆时间
- 门票价格、购票方式
- 参观规则、注意事项
- 地址、交通、停车
- 联系方式、客服
- 拍照规定、禁止事项
- 导览服务、讲解时间

**CULTURE** - 文化背景和藏品知识：
- 藏品历史、文化背景
- 文物介绍、制作工艺
- 朝代历史、文化故事
- 艺术价值、收藏意义
- 考古发现、文物保护
- 传统文化、民俗风情

**RECOMMEND** - 推荐和建议：
- 推荐展览、展品
- 参观路线建议
- 必看藏品推荐
- 适合特定人群的展览
- 个性化推荐

## 用户输入：
唐代的藏品呢？它们有什么故事
## 要求：
请仅返回以下三个选项之一，不要包含其他内容：
RULES
CULTURE
RECOMMEND

2025-09-15 21:38:33.526 [http-nio-8090-exec-9] DEBUG c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类 - LLM原始回复: CULTURE
2025-09-15 21:38:33.526 [http-nio-8090-exec-9] DEBUG c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类 - 标准化后: CULTURE
2025-09-15 21:38:33.526 [http-nio-8090-exec-9] INFO  c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类结果 - 用户输入: '唐代的藏品呢？它们有什么故事' -> 意图: CULTURE
2025-09-15 21:38:33.526 [http-nio-8090-exec-9] INFO  com.museum.service.impl.agent.GuideAgentService - 意图分类完成 - 会话ID: test-session-001, 分类结果: CULTURE
2025-09-15 21:38:33.526 [http-nio-8090-exec-9] DEBUG com.museum.service.impl.agent.GuideAgentService - 开始路由到对应工具 - 意图: CULTURE
2025-09-15 21:38:33.526 [http-nio-8090-exec-9] INFO  com.museum.service.impl.agent.IntentRouterImpl - 路由决策 - 意图: CULTURE -> 工具: CultureRAGTool
2025-09-15 21:38:33.526 [http-nio-8090-exec-9] DEBUG com.museum.service.impl.agent.IntentRouterImpl - 执行工具 - 工具: CultureRAGTool, 用户输入: '唐代的藏品呢？它们有什么故事', 会话ID: test-session-001
2025-09-15 21:38:33.673 [http-nio-8090-exec-9] INFO  com.museum.service.impl.agent.CultureRAGTool - RAG查询 - 会话ID: test-session-001, 用户输入: 唐代的藏品呢？它们有什么故事, 检索文档数: 5, 相关性分数: 0.684
2025-09-15 21:39:13.303 [http-nio-8090-exec-9] INFO  com.museum.service.impl.agent.IntentRouterImpl - 工具执行完成 - 工具: CultureRAGTool, 响应长度: 1633 字符
2025-09-15 21:39:13.303 [http-nio-8090-exec-9] INFO  com.museum.service.impl.agent.GuideAgentService - 消息处理完成 - 会话ID: test-session-001, 响应长度: 1633 字符
2025-09-15 21:39:13.303 [http-nio-8090-exec-9] DEBUG com.museum.service.impl.agent.GuideAgentService - 完整响应内容: 在提供的上下文信息中，提到的唐代藏品是“**霓裳经变图**”，它来自敦煌莫高窟第112窟，是唐代至元代时期的重要壁画残片。以下是关于这件唐代藏品的详细信息和故事：

---

### **藏品名称：霓裳经变图**

#### **来源与品类**
- **来源**：唐/元-敦煌
- **品类**：唐/元-敦煌
- **展厅**：展厅四
- **简介**：此壁画残片出自敦煌莫高窟第112窟，原为《西方净土变》乐舞局部。画面以朱砂铺底，青金石绘制天衣，乐天琵琶弦以金箔勾勒。元代重绘时，画匠在唐人身姿间添入蒙古族簪花冠饰，形成时空叠影。敦煌遗书P.3808号载：“夜半琵琶弦自鸣，壁上飞天离墙三寸”，正与此画异象相合。

---

### **故事与背景**

这幅壁画的创作与唐代画工张素卿密切相关，同时也涉及舞姬裴娥眉的悲情故事。

1. **唐代画工张素卿与裴娥眉的隐秘情感**
   - 唐代天宝十载（751年），画工张素卿受命在莫高窟东壁绘制《霓裳羽衣曲》乐舞场景。
   - 他在壁画中将被逐出长安的舞姬裴娥眉的身影藏进了琵琶天女的侧颜中。裴娥眉因安禄山进献的胡旋舞姬得宠而失势，琵琶四弦尽断于玉门关外。
   - 张素卿用从龟兹驼队带回的雌黄点染她的唇色，但不知调色的水盂中混入了沙州烽燧狼烟熏黑的雪水，为画面增添了一抹悲情的色彩。

2. **西夏画师野利仁荣的重修**
   - 到了元代大德六年（1302年），党项画师野利仁荣奉命重修此窟。
   - 当他刮去宋代覆盖的石灰层时，唐代青金石突然在暮色中泛起幽光。
   - 野利仁荣以西夏宫廷秘传的“透骨青”技法补画，笔尖触到琵琶弦的刹那，竟听见一声冰弦轻振——那是裴娥眉在壁画深处拨动的断弦。
   - 他在蒙古供养人袍角添了一笔唐式卷草纹，次日晨光中，那纹路竟蔓延成裴娥眉未跳完的拓枝舞步。

3. **元代画工亦黑迷失的发现**
   - 至正二十三年（1363年），色目画工亦黑迷失用波斯银朱覆盖斑驳的乐天群像时，壁画突然剥落一片，露出张素卿当年用焦墨写的蝇头小楷：“元和九年六月初七，夜见飞天离壁，霓裳半曲绕梁”。
   - 他以回鹘式晕染法修补琵琶时，金箔下渗出朱砂写的西夏文：“嵬名野利氏，补此琵琶弦，愿续未央舞”。

4. **跨越时空的对话**
   - 张素卿和野利仁荣的画作在壁画夹层中形成隐秘的对话：张素卿用唐代五弦谱在飞天裙裾上记谱，野利仁荣以西夏骨勒笔法在云气间注解。
   - 裴娥眉的断弦被接上党项马尾弦，野利仁荣的银朱却被渗出的唐彩染成海棠色。
   - 元大都沦陷的消息传来时，野利仁荣试图凿开壁画触碰唐代幻影，却发现历代颜料已凝结成晶莹的泪滴状琉璃——那是莫高窟砂岩中的石英，被五百年间画工们的呼吸灼成的岁月舍利。

5. **现代的发现**
   - 1964年，敦煌研究院用红外摄影发现：元代覆盖层下，唐代琵琶天女的眼中藏着一粒西夏青金石，而蒙古供养人的掌心握着半枚开元通宝。
   - 近年X荧光检测显示，壁画最深处的白垩层上，有用木炭写的八思巴文与汉文回文诗，在紫外线下交叠成同心圆——那是至正二十三年某个沙暴夜，野利仁荣与裴娥眉隔着时空画下的婚契。

6. **奇妙的共鸣**
   - 如今站在壁画前，若在夏至日卯时初刻闭目聆听，风穿过榆林窟的声响会与壁画中五弦琵琶共振，在洞窟地面投下两个相拥的影子：一个是唐襦半褪的琵琶天女，一个是蒙古袍襟散开的画工。
   - 他们的衣带在晨光中化为十二世纪的西夏云纹，而影子始终差半寸才能重叠——正如莫高窟崖壁上那些永远错时的爱情。

---

### **总结**
“霓裳经变图”不仅是一件唐代艺术杰作，更是一部跨越时空的情感史诗。它承载了张素卿与裴娥眉的隐秘情愫、野利仁荣的匠心修补，以及后世画工与研究者的发现与感悟。这幅壁画通过不同时代的重绘与修复，形成了独特的时空叠影，成为敦煌艺术与历史的重要见证。
2025-09-15 21:41:33.946 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-15 21:41:33.952 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-15 21:41:33.953 [pool-4-thread-1] WARN  io.lettuce.core.RedisChannelHandler - Connection is already closed
2025-09-15 21:41:33.955 [pool-4-thread-1] DEBUG com.museum.service.impl.ReserveOrderAsyncService - 处理预约订单异常
org.springframework.data.redis.RedisSystemException: Redis exception; nested exception is io.lettuce.core.RedisException: Connection closed
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:74)
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:41)
	at org.springframework.data.redis.PassThroughExceptionTranslationStrategy.translate(PassThroughExceptionTranslationStrategy.java:44)
	at org.springframework.data.redis.FallbackExceptionTranslationStrategy.translate(FallbackExceptionTranslationStrategy.java:42)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.convertLettuceAccessException(LettuceConnection.java:272)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.await(LettuceConnection.java:1063)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.lambda$doInvoke$4(LettuceConnection.java:920)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$Synchronizer.invoke(LettuceInvoker.java:673)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$DefaultManyInvocationSpec.toList(LettuceInvoker.java:618)
	at org.springframework.data.redis.connection.lettuce.LettuceStreamCommands.xReadGroup(LettuceStreamCommands.java:350)
	at org.springframework.data.redis.connection.DefaultedRedisConnection.xReadGroup(DefaultedRedisConnection.java:617)
	at org.springframework.data.redis.connection.DefaultStringRedisConnection.xReadGroup(DefaultStringRedisConnection.java:4795)
	at org.springframework.data.redis.core.DefaultStreamOperations$4.inRedis(DefaultStreamOperations.java:310)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:387)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:382)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:223)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:120)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisException: Connection closed
	at io.lettuce.core.protocol.DefaultEndpoint.notifyDrainQueuedCommands(DefaultEndpoint.java:679)
	at io.lettuce.core.protocol.CommandHandler.channelInactive(CommandHandler.java:358)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.protocol.RedisHandshakeHandler.channelInactive(RedisHandshakeHandler.java:89)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.ChannelGroupListener.channelInactive(ChannelGroupListener.java:69)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 21:41:33.971 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-15 21:41:33.975 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-15 21:41:33.981 [pool-4-thread-1] WARN  io.lettuce.core.RedisChannelHandler - Connection is already closed
2025-09-15 21:41:33.983 [pool-4-thread-1] DEBUG com.museum.service.impl.ReserveOrderAsyncService - 处理预约订单异常
org.springframework.data.redis.RedisSystemException: Redis exception; nested exception is io.lettuce.core.RedisException: Connection closed
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:74)
	at org.springframework.data.redis.connection.lettuce.LettuceExceptionConverter.convert(LettuceExceptionConverter.java:41)
	at org.springframework.data.redis.PassThroughExceptionTranslationStrategy.translate(PassThroughExceptionTranslationStrategy.java:44)
	at org.springframework.data.redis.FallbackExceptionTranslationStrategy.translate(FallbackExceptionTranslationStrategy.java:42)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.convertLettuceAccessException(LettuceConnection.java:272)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.await(LettuceConnection.java:1063)
	at org.springframework.data.redis.connection.lettuce.LettuceConnection.lambda$doInvoke$4(LettuceConnection.java:920)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$Synchronizer.invoke(LettuceInvoker.java:673)
	at org.springframework.data.redis.connection.lettuce.LettuceInvoker$DefaultManyInvocationSpec.toList(LettuceInvoker.java:618)
	at org.springframework.data.redis.connection.lettuce.LettuceStreamCommands.xReadGroup(LettuceStreamCommands.java:350)
	at org.springframework.data.redis.connection.DefaultedRedisConnection.xReadGroup(DefaultedRedisConnection.java:617)
	at org.springframework.data.redis.connection.DefaultStringRedisConnection.xReadGroup(DefaultStringRedisConnection.java:4795)
	at org.springframework.data.redis.core.DefaultStreamOperations$4.inRedis(DefaultStreamOperations.java:310)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:387)
	at org.springframework.data.redis.core.DefaultStreamOperations$RecordDeserializingRedisCallback.doInRedis(DefaultStreamOperations.java:382)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:223)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:120)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisException: Connection closed
	at io.lettuce.core.protocol.DefaultEndpoint.notifyDrainQueuedCommands(DefaultEndpoint.java:679)
	at io.lettuce.core.protocol.CommandHandler.channelInactive(CommandHandler.java:358)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:303)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.protocol.RedisHandshakeHandler.channelInactive(RedisHandshakeHandler.java:89)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.ChannelGroupListener.channelInactive(ChannelGroupListener.java:69)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 21:41:34.070 [pool-4-thread-1] ERROR com.museum.service.impl.ReserveOrderAsyncService - 处理Pending-list出现系统异常
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1689)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1597)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1383)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1366)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1093)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:421)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:193)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:144)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:105)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:210)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.handlePendingList(ReserveOrderAsyncService.java:150)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:142)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:330)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:216)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:115)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:115)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1595)
	... 18 common frames omitted
Caused by: java.lang.IllegalStateException: executor not accepting a task
	at io.netty.resolver.AddressResolverGroup.getResolver(AddressResolverGroup.java:61)
	at io.netty.bootstrap.Bootstrap.doResolveAndConnect0(Bootstrap.java:208)
	at io.netty.bootstrap.Bootstrap.access$000(Bootstrap.java:46)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:189)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:175)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:590)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:557)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:492)
	at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:636)
	at io.netty.util.concurrent.DefaultPromise.setSuccess0(DefaultPromise.java:625)
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:105)
	at io.netty.channel.DefaultChannelPromise.trySuccess(DefaultChannelPromise.java:84)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetSuccess(AbstractChannel.java:990)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.register0(AbstractChannel.java:516)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.access$200(AbstractChannel.java:429)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$1.run(AbstractChannel.java:486)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 21:41:34.084 [pool-4-thread-1] ERROR com.museum.service.impl.ReserveOrderAsyncService - 处理Pending-list出现系统异常
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1689)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1597)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1383)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1366)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1093)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:421)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:193)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:144)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:105)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:210)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.AbstractOperations.execute(AbstractOperations.java:97)
	at org.springframework.data.redis.core.DefaultStreamOperations.read(DefaultStreamOperations.java:305)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.handlePendingList(ReserveOrderAsyncService.java:150)
	at com.museum.service.impl.ReserveOrderAsyncService$ReserveOrderHandler.run(ReserveOrderAsyncService.java:142)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to 127.0.0.1/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:330)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:216)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:115)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:115)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1595)
	... 18 common frames omitted
Caused by: java.lang.IllegalStateException: executor not accepting a task
	at io.netty.resolver.AddressResolverGroup.getResolver(AddressResolverGroup.java:61)
	at io.netty.bootstrap.Bootstrap.doResolveAndConnect0(Bootstrap.java:208)
	at io.netty.bootstrap.Bootstrap.access$000(Bootstrap.java:46)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:189)
	at io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:175)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:590)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:557)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:492)
	at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:636)
	at io.netty.util.concurrent.DefaultPromise.setSuccess0(DefaultPromise.java:625)
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:105)
	at io.netty.channel.DefaultChannelPromise.trySuccess(DefaultChannelPromise.java:84)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetSuccess(AbstractChannel.java:990)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.register0(AbstractChannel.java:516)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.access$200(AbstractChannel.java:429)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$1.run(AbstractChannel.java:486)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-09-15 21:41:37.682 [main] INFO  com.museum.MybatisplusApplication - Starting MybatisplusApplication using Java 17.0.14 on thinkmacbook with PID 57456 (G:\dissertation\Bowucode\正确版本\museum_server\target\classes started by Ezekiel in G:\dissertation\Bowucode\正确版本\museum_server)
2025-09-15 21:41:37.683 [main] DEBUG com.museum.MybatisplusApplication - Running with Spring Boot v2.7.16, Spring v5.3.30
2025-09-15 21:41:37.684 [main] INFO  com.museum.MybatisplusApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-15 21:41:38.163 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-15 21:41:38.163 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-15 21:41:38.180 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-09-15 21:41:38.605 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8091 (http)
2025-09-15 21:41:38.609 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-15 21:41:38.610 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.80]
2025-09-15 21:41:38.713 [main] INFO  o.a.c.c.ContainerBase.[Tomcat].[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-09-15 21:41:38.714 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 996 ms
2025-09-15 21:41:38.963 [main] INFO  com.museum.MybatisplusApplication - Starting MybatisplusApplication using Java 17.0.14 on thinkmacbook with PID 60476 (G:\dissertation\Bowucode\正确版本\museum_server\target\classes started by Ezekiel in G:\dissertation\Bowucode\正确版本\museum_server)
2025-09-15 21:41:38.965 [main] DEBUG com.museum.MybatisplusApplication - Running with Spring Boot v2.7.16, Spring v5.3.30
2025-09-15 21:41:38.966 [main] INFO  com.museum.MybatisplusApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-15 21:41:39.262 [main] INFO  org.redisson.Version - Redisson 3.13.6
2025-09-15 21:41:39.445 [redisson-netty-4-14] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for /127.0.0.1:6379
2025-09-15 21:41:39.451 [redisson-netty-4-19] INFO  org.redisson.connection.pool.MasterConnectionPool - 24 connections initialized for /127.0.0.1:6379
2025-09-15 21:41:39.496 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-15 21:41:39.498 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-15 21:41:39.514 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Redis repository interfaces.
2025-09-15 21:41:39.569 [main] INFO  com.museum.config.ChromaConfig - Attempting to connect to Chroma at: http://localhost:8000/
2025-09-15 21:41:39.716 [main] INFO  com.museum.config.ChromaConfig - Successfully connected to Chroma
2025-09-15 21:41:39.873 [main] INFO  com.museum.service.impl.agent.IntentRouterImpl - 意图路由器初始化完成 - 已注册工具: [RULES, CULTURE, RECOMMEND]
2025-09-15 21:41:39.883 [main] INFO  com.museum.service.impl.ReserveExpirationService - 服务启动时执行预约过期检查...
2025-09-15 21:41:39.924 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-15 21:41:39.973 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8090 (http)
2025-09-15 21:41:39.979 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-15 21:41:39.979 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.80]
2025-09-15 21:41:40.091 [main] INFO  o.a.c.c.ContainerBase.[Tomcat].[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-09-15 21:41:40.091 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1079 ms
2025-09-15 21:41:40.102 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-15 21:41:40.105 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==>  Preparing: SELECT order_id,user_id,user_name,res_id,vld_stat,res_session,res_type,res_date,res_time FROM ms_reserve_detail WHERE (vld_stat = ? AND res_date < ?)
2025-09-15 21:41:40.121 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==> Parameters: 1(String), 2025-09-15(String)
2025-09-15 21:41:40.133 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - <==      Total: 0
2025-09-15 21:41:40.136 [main] INFO  com.museum.service.impl.ReserveExpirationService - 找到 0 条过期预约
2025-09-15 21:41:40.136 [main] INFO  com.museum.service.impl.ReserveExpirationService - 过期预约检查完成，共处理 0 条记录
2025-09-15 21:41:40.517 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8091 (http) with context path '/api'
2025-09-15 21:41:40.632 [main] INFO  org.redisson.Version - Redisson 3.13.6
2025-09-15 21:41:40.777 [main] INFO  com.museum.MybatisplusApplication - Started MybatisplusApplication in 3.316 seconds (JVM running for 3.707)
2025-09-15 21:41:40.784 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection info: {"id":"77cc06b4-84ae-4fa2-be88-58941f17d96e","name":"museum-collection","configuration_json":{"hnsw_configuration":{"space":"l2","ef_construction":100,"ef_search":10,"num_threads":24,"M":16,"resize_factor":1.2,"batch_size":1000,"sync_threshold":100,"_type":"HNSWConfigurationInternal"},"_type":"CollectionConfigurationInternal"},"metadata":{"hnsw:space":"cosine"},"dimension":null,"tenant":"default_tenant","database":"default_database","version":0}
2025-09-15 21:41:40.784 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Found collection ID: 77cc06b4-84ae-4fa2-be88-58941f17d96e
2025-09-15 21:41:40.793 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection count response: 0
2025-09-15 21:41:40.793 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 向量数据库中已有 0 条数据
2025-09-15 21:41:40.793 [main] INFO  com.museum.service.impl.agent.DataInitializer - 开始初始化向量数据...
2025-09-15 21:41:40.793 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 开始初始化向量数据库...
2025-09-15 21:41:40.795 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - ==>  Preparing: SELECT id,title,origin,cate_id,des_coll,col_pic,base,display_room,crt_tm,view_cnt FROM ms_collection
2025-09-15 21:41:40.795 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - ==> Parameters: 
2025-09-15 21:41:40.799 [main] DEBUG com.museum.mapper.CollectionMapper.selectList - <==      Total: 9
2025-09-15 21:41:40.814 [redisson-netty-4-23] INFO  o.r.connection.pool.MasterPubSubConnectionPool - 1 connections initialized for /127.0.0.1:6379
2025-09-15 21:41:40.823 [redisson-netty-4-19] INFO  org.redisson.connection.pool.MasterConnectionPool - 24 connections initialized for /127.0.0.1:6379
2025-09-15 21:41:40.936 [main] INFO  com.museum.config.ChromaConfig - Attempting to connect to Chroma at: http://localhost:8000/
2025-09-15 21:41:40.994 [main] INFO  com.museum.config.ChromaConfig - Successfully connected to Chroma
2025-09-15 21:41:41.141 [main] INFO  com.museum.service.impl.agent.IntentRouterImpl - 意图路由器初始化完成 - 已注册工具: [RULES, CULTURE, RECOMMEND]
2025-09-15 21:41:41.153 [main] INFO  com.museum.service.impl.ReserveExpirationService - 服务启动时执行预约过期检查...
2025-09-15 21:41:41.192 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-15 21:41:41.384 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-15 21:41:41.388 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==>  Preparing: SELECT order_id,user_id,user_name,res_id,vld_stat,res_session,res_type,res_date,res_time FROM ms_reserve_detail WHERE (vld_stat = ? AND res_date < ?)
2025-09-15 21:41:41.406 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==> Parameters: 1(String), 2025-09-15(String)
2025-09-15 21:41:41.420 [main] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - <==      Total: 0
2025-09-15 21:41:41.423 [main] INFO  com.museum.service.impl.ReserveExpirationService - 找到 0 条过期预约
2025-09-15 21:41:41.423 [main] INFO  com.museum.service.impl.ReserveExpirationService - 过期预约检查完成，共处理 0 条记录
2025-09-15 21:41:41.435 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 殷墟·夔纹卜骨
2025-09-15 21:41:41.642 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 钧窑天青盏
2025-09-15 21:41:41.820 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8090 (http) with context path '/api'
2025-09-15 21:41:41.853 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 璇玑陶楼
2025-09-15 21:41:42.026 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 香妃链
2025-09-15 21:41:42.048 [main] INFO  com.museum.MybatisplusApplication - Started MybatisplusApplication in 3.303 seconds (JVM running for 3.692)
2025-09-15 21:41:42.054 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection info: {"id":"77cc06b4-84ae-4fa2-be88-58941f17d96e","name":"museum-collection","configuration_json":{"hnsw_configuration":{"space":"l2","ef_construction":100,"ef_search":10,"num_threads":24,"M":16,"resize_factor":1.2,"batch_size":1000,"sync_threshold":100,"_type":"HNSWConfigurationInternal"},"_type":"CollectionConfigurationInternal"},"metadata":{"hnsw:space":"cosine"},"dimension":1536,"tenant":"default_tenant","database":"default_database","version":0}
2025-09-15 21:41:42.054 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Found collection ID: 77cc06b4-84ae-4fa2-be88-58941f17d96e
2025-09-15 21:41:42.058 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - Collection count response: 4
2025-09-15 21:41:42.058 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 向量数据库中已有 4 条数据
2025-09-15 21:41:42.058 [main] INFO  com.museum.service.impl.agent.DataInitializer - 向量数据已存在，跳过初始化
2025-09-15 21:41:42.220 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 霓裳经变图
2025-09-15 21:41:42.406 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 鹤影澄泥砚
2025-09-15 21:41:42.594 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 长信夔凤镜
2025-09-15 21:41:42.768 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 虺龙璇玑璧
2025-09-15 21:41:42.944 [main] DEBUG com.museum.service.impl.agent.VectorSyncService - 已添加藏品向量: 玄奘九环锡杖
2025-09-15 21:41:42.945 [main] INFO  com.museum.service.impl.agent.VectorSyncService - 成功初始化 9 个藏品到向量数据库
2025-09-15 21:41:42.945 [main] INFO  com.museum.service.impl.agent.DataInitializer - 向量数据初始化完成
2025-09-15 21:41:57.053 [http-nio-8090-exec-2] INFO  o.a.c.c.ContainerBase.[Tomcat].[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-15 21:41:57.054 [http-nio-8090-exec-2] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-15 21:41:57.054 [http-nio-8090-exec-2] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-09-15 21:41:57.081 [http-nio-8090-exec-2] INFO  com.museum.service.impl.agent.GuideAgentService - 开始处理用户消息 - 会话ID: test-session-001, 消息: '唐代的藏品呢？和我说两个藏品吧，再说说它们有什么故事'
2025-09-15 21:41:57.082 [http-nio-8090-exec-2] DEBUG c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类 - 用户输入: 唐代的藏品呢？和我说两个藏品吧，再说说它们有什么故事
2025-09-15 21:41:57.082 [http-nio-8090-exec-2] DEBUG c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类 - 发送给LLM的prompt: 请判断以下用户输入的意图类型，严格按照以下规则分类：

## 分类规则：

**RULES** - 规章制度和基本信息查询：
- 博物馆开放时间、闭馆时间
- 门票价格、购票方式
- 参观规则、注意事项
- 地址、交通、停车
- 联系方式、客服
- 拍照规定、禁止事项
- 导览服务、讲解时间

**CULTURE** - 文化背景和藏品知识：
- 藏品历史、文化背景
- 文物介绍、制作工艺
- 朝代历史、文化故事
- 艺术价值、收藏意义
- 考古发现、文物保护
- 传统文化、民俗风情

**RECOMMEND** - 推荐和建议：
- 推荐展览、展品
- 参观路线建议
- 必看藏品推荐
- 适合特定人群的展览
- 个性化推荐

## 用户输入：
唐代的藏品呢？和我说两个藏品吧，再说说它们有什么故事
## 要求：
请仅返回以下三个选项之一，不要包含其他内容：
RULES
CULTURE
RECOMMEND

2025-09-15 21:41:57.602 [http-nio-8090-exec-2] DEBUG c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类 - LLM原始回复: CULTURE
2025-09-15 21:41:57.602 [http-nio-8090-exec-2] DEBUG c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类 - 标准化后: CULTURE
2025-09-15 21:41:57.602 [http-nio-8090-exec-2] INFO  c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类结果 - 用户输入: '唐代的藏品呢？和我说两个藏品吧，再说说它们有什么故事' -> 意图: CULTURE
2025-09-15 21:41:57.602 [http-nio-8090-exec-2] INFO  com.museum.service.impl.agent.GuideAgentService - 意图分类完成 - 会话ID: test-session-001, 分类结果: CULTURE
2025-09-15 21:41:57.602 [http-nio-8090-exec-2] DEBUG com.museum.service.impl.agent.GuideAgentService - 开始路由到对应工具 - 意图: CULTURE
2025-09-15 21:41:57.602 [http-nio-8090-exec-2] INFO  com.museum.service.impl.agent.IntentRouterImpl - 路由决策 - 意图: CULTURE -> 工具: CultureRAGTool
2025-09-15 21:41:57.602 [http-nio-8090-exec-2] DEBUG com.museum.service.impl.agent.IntentRouterImpl - 执行工具 - 工具: CultureRAGTool, 用户输入: '唐代的藏品呢？和我说两个藏品吧，再说说它们有什么故事', 会话ID: test-session-001
2025-09-15 21:41:57.786 [http-nio-8090-exec-2] INFO  com.museum.service.impl.agent.CultureRAGTool - RAG查询 - 会话ID: test-session-001, 用户输入: 唐代的藏品呢？和我说两个藏品吧，再说说它们有什么故事, 检索文档数: 5, 相关性分数: 0.677
2025-09-15 21:42:21.827 [http-nio-8090-exec-2] INFO  com.museum.service.impl.agent.IntentRouterImpl - 工具执行完成 - 工具: CultureRAGTool, 响应长度: 1163 字符
2025-09-15 21:42:21.827 [http-nio-8090-exec-2] INFO  com.museum.service.impl.agent.GuideAgentService - 消息处理完成 - 会话ID: test-session-001, 响应长度: 1163 字符
2025-09-15 21:42:21.827 [http-nio-8090-exec-2] DEBUG com.museum.service.impl.agent.GuideAgentService - 完整响应内容: 根据提供的上下文信息，唐代的藏品中最为精彩的两个代表是《霓裳经变图》和《长信夔凤镜》。以下是它们的详细介绍和背后的故事：

---

### 1. **霓裳经变图**
**来源**：唐/元-敦煌  
**品类**：壁画  
**展厅**：展厅四  

#### 故事背景：
《霓裳经变图》是唐代画工张素卿在莫高窟东壁所绘的《霓裳羽衣曲》乐舞壁画。画中隐藏了舞姬裴娥眉的身影，她因安禄山进献的胡旋舞姬得宠而被逐出长安，琵琶四弦尽断于玉门关外。张素卿用驼队从龟兹带回的雌黄点染她的唇色，却不知调色的水盂中混入了沙州烽燧狼烟熏黑的雪水，使壁画充满了命运的悲怆感。

#### 历史与文化意义：
这幅壁画不仅展现了唐代乐舞的辉煌，还记录了画工与舞姬之间跨越时空的情感联系。在后来的元代，党项画师野利仁荣奉命重修此窟时，竟在补画过程中听到了壁画深处裴娥眉拨动的断弦声。更令人惊叹的是，蒙古供养人的袍角上出现了裴娥眉未跳完的拓枝舞步，仿佛画中人物跨越时空完成了未竟的舞蹈。

#### 现代发现：
1964年，敦煌研究院用红外摄影发现：元代覆盖层下，唐代琵琶天女的眼中藏着一粒西夏青金石，而蒙古供养人的掌心握着半枚开元通宝。近年X荧光检测还显示，壁画最深处的白垩层上，有用木炭写的八思巴文与汉文回文诗，在紫外线下交叠成同心圆——那是至正二十三年某个沙暴夜，野利仁荣与裴娥眉隔着时空画下的婚契。

---

### 2. **长信夔凤镜**
**来源**：汉-长安（唐代及之后仍流传）  
**品类**：铜器  
**展厅**：展厅二  

#### 故事背景：
这面铜镜最初铸造于汉代，传说它曾照见过未央宫最凉的月色。镜中常现陈阿娇长门殿舞影，宫人私语，说那是孝武皇帝第一个皇后留在世间的叹息。王昭君出塞前夜，此镜从妆台跌落裂了蟠螭左角，侍女看见裂痕里渗出的不是铜锈，而是胭脂色的泪痕。

#### 历史与文化意义：
这面铜镜在唐代及之后的朝代中继续流传，见证了无数历史时刻。北宋汴京七夕，这面流落民间的铜镜被摆在潘楼街市，少女们争相以镜映月，镜背夔凤竟在粉墙上投出穿花的影子。李清照在《金石录后序》里追忆，赵明诚曾用此镜折射月光，在《西岳华山庙碑》拓片上显出了隐藏的秦代祷雨辞。

#### 现代发现：
1974年考古队员清理镜面时，哈气凝露处显出四个反书小字“长乐未央”，笔迹与马王堆汉墓遣策上的“君幸酒”朱书如出一手。那些被铜绿掩埋的誓言，终究比未央宫的瓦当更耐得住流年。

---

### 总结
《霓裳经变图》和《长信夔凤镜》都是唐代及之后流传下来的珍贵文物，它们不仅具有极高的艺术价值，还承载了深厚的历史文化内涵。这些藏品通过其独特的形式和背后的故事，将我们带入了唐代的社会生活、情感世界和文化氛围中，成为连接古今的重要纽带。
2025-09-15 21:44:00.803 [http-nio-8090-exec-5] INFO  com.museum.service.impl.agent.GuideAgentService - 开始处理用户消息 - 会话ID: test-session-001, 消息: '最近有什么新奇的展览吗'
2025-09-15 21:44:00.804 [http-nio-8090-exec-5] DEBUG c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类 - 用户输入: 最近有什么新奇的展览吗
2025-09-15 21:44:00.804 [http-nio-8090-exec-5] DEBUG c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类 - 发送给LLM的prompt: 请判断以下用户输入的意图类型，严格按照以下规则分类：

## 分类规则：

**RULES** - 规章制度和基本信息查询：
- 博物馆开放时间、闭馆时间
- 门票价格、购票方式
- 参观规则、注意事项
- 地址、交通、停车
- 联系方式、客服
- 拍照规定、禁止事项
- 导览服务、讲解时间

**CULTURE** - 文化背景和藏品知识：
- 藏品历史、文化背景
- 文物介绍、制作工艺
- 朝代历史、文化故事
- 艺术价值、收藏意义
- 考古发现、文物保护
- 传统文化、民俗风情

**RECOMMEND** - 推荐和建议：
- 推荐展览、展品
- 参观路线建议
- 必看藏品推荐
- 适合特定人群的展览
- 个性化推荐

## 用户输入：
最近有什么新奇的展览吗
## 要求：
请仅返回以下三个选项之一，不要包含其他内容：
RULES
CULTURE
RECOMMEND

2025-09-15 21:44:01.240 [http-nio-8090-exec-5] DEBUG c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类 - LLM原始回复: RECOMMEND
2025-09-15 21:44:01.240 [http-nio-8090-exec-5] DEBUG c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类 - 标准化后: RECOMMEND
2025-09-15 21:44:01.240 [http-nio-8090-exec-5] INFO  c.m.service.impl.agent.IntentClassifierServiceImpl - 意图分类结果 - 用户输入: '最近有什么新奇的展览吗' -> 意图: RECOMMEND
2025-09-15 21:44:01.240 [http-nio-8090-exec-5] INFO  com.museum.service.impl.agent.GuideAgentService - 意图分类完成 - 会话ID: test-session-001, 分类结果: RECOMMEND
2025-09-15 21:44:01.240 [http-nio-8090-exec-5] DEBUG com.museum.service.impl.agent.GuideAgentService - 开始路由到对应工具 - 意图: RECOMMEND
2025-09-15 21:44:01.240 [http-nio-8090-exec-5] INFO  com.museum.service.impl.agent.IntentRouterImpl - 路由决策 - 意图: RECOMMEND -> 工具: RecommendTool
2025-09-15 21:44:01.240 [http-nio-8090-exec-5] DEBUG com.museum.service.impl.agent.IntentRouterImpl - 执行工具 - 工具: RecommendTool, 用户输入: '最近有什么新奇的展览吗', 会话ID: test-session-001
2025-09-15 21:44:01.243 [http-nio-8090-exec-5] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==>  Preparing: SELECT order_id,user_id,user_name,res_id,vld_stat,res_session,res_type,res_date,res_time FROM ms_reserve_detail WHERE (user_id = ? AND vld_stat = ?)
2025-09-15 21:44:01.244 [http-nio-8090-exec-5] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - ==> Parameters: test-session-001(String), 1(String)
2025-09-15 21:44:01.245 [http-nio-8090-exec-5] DEBUG com.museum.mapper.ReserveDetialMapper.selectList - <==      Total: 0
2025-09-15 21:44:02.957 [http-nio-8090-exec-5] INFO  com.museum.service.impl.agent.IntentRouterImpl - 工具执行完成 - 工具: RecommendTool, 响应长度: 64 字符
2025-09-15 21:44:02.958 [http-nio-8090-exec-5] INFO  com.museum.service.impl.agent.GuideAgentService - 消息处理完成 - 会话ID: test-session-001, 响应长度: 64 字符
2025-09-15 21:44:02.958 [http-nio-8090-exec-5] DEBUG com.museum.service.impl.agent.GuideAgentService - 完整响应内容: 根据当前信息，馆内暂时没有展览信息可供推荐。  
如果您对馆内的常设藏品或其他相关信息感兴趣，我可以为您介绍，请问是否需要了解？
